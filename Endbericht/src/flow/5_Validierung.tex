\subsection{Validierung}
Das folgende Kapitel gibt einen kurzen Überblick über die Ergebnisse der Teilgruppe Materialfluss. Dazu werden zu Anfang die erreichten Funktionalitäten aufgezeigt. Im Anschluss daran werden die wesentlichen Probleme und Herausforderungen, die während der Projektarbeit aufgetreten sind, aufgezeigt. Zum Schluss des Kapitels wird ein Ausblick gegeben, in dem beschrieben wird, welche weiterführenden Funktionalitäten aus unserer Sicht durch spätere Projektgruppen noch entwickelt werden können.

\subsubsection{Erreichte Funktionalität}
Während der Projektarbeit wurde ein lauffähiges System für den Materialfluss auf Agentenbasis fertiggestellt. Zunächst wurde dafür ein vollständiges Agenten-System auf den unterschiedlichen Modulen umgesetzt. Es erlaubt die parallele Arbeit von bis zu sieben Agenten pro \textsc{Mica}z-Modul und den Austausch von Agenten-Nachrichten sowohl innerhalb eines Moduls als auch modulübergreifend. So ermöglicht es die Überwachung und Lokalisierung aller Rampen und Pakete, die sich im System befinden.

Ein am Eingang liegendes Paket kann durch das System bis zu einem gewünschten Ausgang transportiert werden. Dazu gehört zum einen, dass die Module untereinander über ihre Funkschnittstelle kommunizieren können. Es wurde außerdem die Kommunikation zwischen den \textsc{Mica}z-Modulen und Volksbots über ein definiertes Kommunikationsprotokoll erfolgreich umgesetzt. Ein weiteres Merkmal in der Funktionalität ist das gelungene Zusammenspiel zwischen Rampen und Modulen, also die Abfrage und die Ansteuerung von Sensorik und Aktorik. Dies erlaubt die Vereinzelung von Paketen durch gezieltes öffnen und schließen der Bolzen. Außerdem wird die Überwachung der einzelnen Rampenplätze durch die angebrachten Lichtschranken ermöglicht. Eine weitere erfolgreich umgesetzte Funktionalität, ist die Möglichkeit Pakete durch das System routen zu lassen. Dabei wird ein verteiltes Protokoll auf Basis von kommunizierenden Zustandsautomaten mit plattformübergreifender Kommunikation der Agenten eingesetzt. 

\subsubsection{Probleme und Herausforderungen}
Während der Projektdurchführung sind wir auf einige Probleme und Herausforderung gestoßen. Auf diese soll in diesem Abschnitt noch einmal ein besonderes Augenmerk gelegt werden. 

In der Produktbeschreibung der \textsc{Mica}z-Module wurde eine Funkreichweite von bis zu 100 Metern beworben. Beim Testen der Funkfunktionalität ist aber sehr schnell deutlich geworden, dass dies mit den Modulen nicht oder nur unter optimalen Laborbedingungen möglich sein würde. Es wurden lediglich Entfernung von zwei bis drei Metern erreicht, wenn die Module während des Funkvorganges im Raum bewegt wurden. Bei starren Positionen wurden Entfernungen von bis zu 5 Metern auf freier Fläche erreicht. Durch Recherche in Datenblättern stellte sich heraus, dass der Flaschenhals der Funkübertragung sehr wahrscheinlich in den mitgelieferten Antennen zu finden sei. Es wurde deshalb neue Antennen mit einem Gewinn von bis zu acht dBi an die \textsc{Mica}z-Module angeschlossen. Außerdem wurde ein selbstentwickeltes Networkflooding-Protokoll implementiert. Bei diesem Verfahren wird jede Nachricht durch ihre Sender-ID und eine Message-ID identifiziert und außerdem wird eine Time-To-Live (kurz TTL) Information angefügt. Wenn ein Empfänger eine ihm noch unbekannte Nachricht empfängt, überprüft er, ob er selbst das beziehungsweise ein Ziel der Nachricht ist. Wenn ja, verarbeitet er die Nachricht. Ansonsten wird die TTL dekrementiert und die Nachricht nochmals an alle erreichbaren Empfänger gesendet.
Diese beiden Maßnahmen erlaubten auch in der Praxis eine sehr stabile Funkverbindung zwischen allen Modulen, die gleichzeitig nicht durch zu viel Overhead beeinträchtigt wurde.

Eine weitere Herausforderung lag im geringen Arbeitsspeicher der Module. Dieser liegt bei lediglich zwei Kilobyte, die allein vom Betriebssystem und dem Kommunikationsstack schon zu etwa 50\% genutzt werden. Dies führte dazu, dass komplexe Routing-Protokolle nicht durchführbar sind. Die Herausforderung wurde dadurch gemeistert, dass ein nachrichtenbasiertes Routing durchgeführt wird, bei dem nahezu alle relevanten Informationen in den einzelnen Agenten-Nachrichten und im Zustand des zugrunde liegenden Automaten gespeichert werden können. 

Die dritte Herausforderung, die hier kurz beschrieben werden soll ist das Debugging in verteilten Hardware-Systemen. Eine genaue Programmabfolge kann in solchen Systemen nur schwer beobachtet werden und Fehler im Ablauf treten durch die nicht-synchronisierten Systeme häufig nicht-deterministisch auf.
Eine große Hilfe war hier der JTAGICE3 von Atmel, der es durch das Setzen von Haltepunkten im Programmcode ermöglicht, Zustände von Variablen und Ausgangspins direkt im laufenden System zu überprüfen,zu analysieren und gar zu verändern.

\subsubsection{Ausblick}
Im folgendem Abschnitt soll ein kurzer Überblick darüber gegeben werden, durch welche Entwicklungen das Projekt in späteren Arbeiten und Projektgruppen erweitert werden kann. 

Hierzu zählt unter anderem das Einbeziehen von Zwischenlager-Rampen in das Routing der Pakete. So kann etwa berechnet werden, ob es kostengünstiger ist, ein Paket vom Eingang zum Ausgang über eine Zwischenrampe zu liefern oder nicht. Außerdem können Pakete, denen noch kein Ziel im System zugewiesen wurde, hier zwischengelagert werden, um Ein- und Ausgangs-Rampen nicht unnötigerweise zu blockieren.
Das Routing kann noch weiter ausgebaut werden, indem Zeitslots und Reservierungen auf Plattformen eingeführt werden werden. So können die Durchlaufzeiten der Pakete und die Gefahr von Deadlocks verringert werden.

Weiterhin kann ein hybrider Modus mit der computergestützten Simulation entwickelt werden. So kann der Zustand der physischen Zelle in der Simulation visualisiert werden und es können virtuelle Pakete aus der Simulation in der physischen Zelle berücksichtigt werden, um das tatsächliche Verhalten beobachten zu können. Für diesen Punkt müsste ein neues Protokoll definiert, abgestimmt und eingebunden werden. Die technischen Grundlagen für ein Gateway, das es ermöglicht, die gesamte drahtlose Kommunikation zu verfolgen, sind bereits vorhanden.

Schließlich ist es möglich, mit den Volksbots nicht nur Rampen, sondern auch existierende Stetigförderer zu bedienen. Für diese muss das AgentenRTE teilweise angepasst und es müssen dedizierte Plattformagenten für jeden Stetigförderer entwickelt werden. So kann das Gesamtsystem deutlich erweitert werden: Durch die Möglichkeit der Stetigförderer, mehrere Pakete in unterschiedlichen Richtungen auszugeben, werden Durchsatz und Flexibilität deutlich erhöht.
