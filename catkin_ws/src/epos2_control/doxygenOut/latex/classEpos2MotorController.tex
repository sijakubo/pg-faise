\hypertarget{classEpos2MotorController}{\section{Epos2\-Motor\-Controller Class Reference}
\label{classEpos2MotorController}\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}}
}


E\-P\-O\-S2-\/\-Motor\-Controller-\/\-Class.  




{\ttfamily \#include $<$Epos2\-Motor\-Controller.\-h$>$}

\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structEpos2MotorController_1_1accelerationData}{acceleration\-Data}
\begin{DoxyCompactList}\small\item\em all relevant acceleration values for the motor \end{DoxyCompactList}\item 
struct \hyperlink{structEpos2MotorController_1_1epos2Settings}{epos2\-Settings}
\begin{DoxyCompactList}\small\item\em Settings Structure with all relevant values. \end{DoxyCompactList}\item 
struct \hyperlink{structEpos2MotorController_1_1feedForward}{feed\-Forward}
\begin{DoxyCompactList}\small\item\em Feedforward values for a regulator. \end{DoxyCompactList}\item 
struct \hyperlink{structEpos2MotorController_1_1gearData}{gear\-Data}
\begin{DoxyCompactList}\small\item\em all values of the gear between motor and wheel. \end{DoxyCompactList}\item 
struct \hyperlink{structEpos2MotorController_1_1motorData}{motor\-Data}
\begin{DoxyCompactList}\small\item\em all relevant Parameter to setup the motor \end{DoxyCompactList}\item 
struct \hyperlink{structEpos2MotorController_1_1regulator}{regulator}
\begin{DoxyCompactList}\small\item\em Structure of all regulator values used by the E\-P\-O\-S2. \end{DoxyCompactList}\item 
struct \hyperlink{structEpos2MotorController_1_1regulatorPI}{regulator\-P\-I}
\begin{DoxyCompactList}\small\item\em Gain values for a P\-I regulator. \end{DoxyCompactList}\item 
struct \hyperlink{structEpos2MotorController_1_1regulatorPID}{regulator\-P\-I\-D}
\begin{DoxyCompactList}\small\item\em Gain value for a P\-I\-D regulator. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{classEpos2MotorController_a5404c60266e24bb6c0ce60153ddcb774}{Type} \{ \hyperlink{classEpos2MotorController_a5404c60266e24bb6c0ce60153ddcb774a2b4b83649b11351ce20e5f3db7dd19f6}{u\-Short\-Int}, 
\hyperlink{classEpos2MotorController_a5404c60266e24bb6c0ce60153ddcb774a7cd8c8c80092885f086841058f4520a9}{u\-Int}, 
\hyperlink{classEpos2MotorController_a5404c60266e24bb6c0ce60153ddcb774ae8b4415995e33e0fdb3318c2bb0ec1fc}{u\-Long\-Int}, 
\hyperlink{classEpos2MotorController_a5404c60266e24bb6c0ce60153ddcb774a6560d2c46b97b38b3c8db72e25563fd2}{double\-T}
 \}
\begin{DoxyCompactList}\small\item\em possible Types of Data in the Parameter structures. \end{DoxyCompactList}\item 
enum \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060c}{Epos\-State} \{ \\*
\hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060cae6493e2426163b114bea951ab9a419d5}{enabled}, 
\hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060caf0eea74682d3d3f21bec6e5b376cf443}{disabled}, 
\hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060caa83d02e81212676710b3c6d97cb30119}{quickstop}, 
\hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060cae80551bbe5d91631014d56926de2d402}{reset}, 
\\*
\hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060ca9c2b33ebbe5a72ad6d09d6af6531237c}{fault}, 
\hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060cad38c41836bbe157863e3eae0d308b7ca}{unknown}
 \}
\begin{DoxyCompactList}\small\item\em internal state of the Motor\-Controller-\/\-Object with respect to the state of the E\-P\-O\-S2 \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classEpos2MotorController_a17d3eddbf93f2fa7622ab734a6c8e615}{Epos2\-Motor\-Controller} (int node, int reverse\-Node, std\-::string port, unsigned long timeout=0, unsigned long baudrate=0)
\begin{DoxyCompactList}\small\item\em Constructor of a Motor\-Controller Object to build up a new communication. \end{DoxyCompactList}\item 
\hyperlink{classEpos2MotorController_a85702068308f7694af8caf78a599ba31}{Epos2\-Motor\-Controller} (int node, int reverse\-Node, void $\ast$new\-Devhandle)
\begin{DoxyCompactList}\small\item\em Constructor of a Motor\-Controller Object with a given communication handler. \end{DoxyCompactList}\item 
\hyperlink{classEpos2MotorController_a897a1929a53a5c5211e925eab8792c90}{$\sim$\-Epos2\-Motor\-Controller} ()
\begin{DoxyCompactList}\small\item\em Release the E\-P\-O\-S2. \end{DoxyCompactList}\item 
int \hyperlink{classEpos2MotorController_a07446045b12515427feda98fea36dab2}{clear\-Fault} ()
\begin{DoxyCompactList}\small\item\em Delete all errors in the Error history of this E\-P\-O\-S2. \end{DoxyCompactList}\item 
int \hyperlink{classEpos2MotorController_a257e06f445d5ecc34f1dbae30e63fc9f}{reset\-Device} ()
\begin{DoxyCompactList}\small\item\em Reset the State Machine inside the E\-P\-O\-S2. \end{DoxyCompactList}\item 
void \hyperlink{classEpos2MotorController_a0c2778ab028417b907d7a55297ccbd4a}{init} (double max\-R\-P\-M, double wheel\-Perimeter)
\begin{DoxyCompactList}\small\item\em calls a few set-\/functions, store the settings in the E\-P\-O\-S2 and enable the Device. \end{DoxyCompactList}\item 
int \hyperlink{classEpos2MotorController_a481615a590e6d1c6bf6c39c426e6d9a6}{test\-For\-Errors\-And\-Print} ()
\begin{DoxyCompactList}\small\item\em read out the error bit and the error history. \end{DoxyCompactList}\item 
int \hyperlink{classEpos2MotorController_aeadc7a21fa6619a4104887f169b9d2fd}{enable\-Epos2} ()
\begin{DoxyCompactList}\small\item\em set the E\-P\-O\-S2 into enable state \end{DoxyCompactList}\item 
int \hyperlink{classEpos2MotorController_ad58ad9fe38c72ce0d457a286973f8a99}{disable\-Epos2} ()
\begin{DoxyCompactList}\small\item\em set the E\-P\-O\-S2 into disable state \end{DoxyCompactList}\item 
int \hyperlink{classEpos2MotorController_a2e1ad71a3be2943ed7bffd743c4f1fad}{store\-Settings} ()
\begin{DoxyCompactList}\small\item\em stores all changed Settings in the E\-P\-O\-S2. \end{DoxyCompactList}\item 
int \hyperlink{classEpos2MotorController_a4f3a4529154e01acb6a15ff94d5c9000}{activate\-Profile\-Velocity} ()
\begin{DoxyCompactList}\small\item\em change the Operation\-Mode of the E\-P\-O\-S2 into Profile\-Velocity\-Mode and set the Motion\-Profile to sin$^\wedge$2-\/ramp \end{DoxyCompactList}\item 
int \hyperlink{classEpos2MotorController_a1b97f5c8fe0c7e2ff3256334c19b7a39}{change\-Rotation\-Per\-Minute} (double target\-Velocity\-R\-P\-M)
\begin{DoxyCompactList}\small\item\em set a target angular velocity for this E\-P\-O\-S2. \end{DoxyCompactList}\item 
\hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060c}{Epos\-State} \hyperlink{classEpos2MotorController_ac6c31e0dc57485aa817431b22627fc70}{get\-Epos2\-State} ()
\begin{DoxyCompactList}\small\item\em read out the state of the E\-P\-O\-S2 state machine \end{DoxyCompactList}\item 
double \hyperlink{classEpos2MotorController_a07b5def07609a91cba8a1977f6436c0a}{get\-Absolute\-Position} ()
\begin{DoxyCompactList}\small\item\em read out the current position value depending on the start position. \end{DoxyCompactList}\item 
int \hyperlink{classEpos2MotorController_a6c806fba7028bed11d710c4f453869b1}{set\-Gear\-Data} (\hyperlink{structEpos2MotorController_1_1gearData}{gear\-Data} $\ast$parameter)
\begin{DoxyCompactList}\small\item\em set all Data of the gear into the E\-P\-O\-S2. \end{DoxyCompactList}\item 
int \hyperlink{classEpos2MotorController_a43b5c84e3d2c891a98fae2c159d0a112}{get\-Gear\-Data} (\hyperlink{structEpos2MotorController_1_1gearData}{gear\-Data} $\ast$parameter)
\begin{DoxyCompactList}\small\item\em read out all Data of the gear from the E\-P\-O\-S2 \end{DoxyCompactList}\item 
int \hyperlink{classEpos2MotorController_a0a5257b20692de37091544e6ed5f6aed}{set\-Motor\-Data} (\hyperlink{structEpos2MotorController_1_1motorData}{motor\-Data} $\ast$parameter)
\begin{DoxyCompactList}\small\item\em set all Data of the motor into the E\-P\-O\-S2. \end{DoxyCompactList}\item 
int \hyperlink{classEpos2MotorController_a0b70bbbfed4fa0c78a9f15dfb593bb9f}{get\-Motor\-Data} (\hyperlink{structEpos2MotorController_1_1motorData}{motor\-Data} $\ast$parameter)
\begin{DoxyCompactList}\small\item\em read out all Data of the motor from the E\-P\-O\-S2 \end{DoxyCompactList}\item 
int \hyperlink{classEpos2MotorController_aada27a05c4f5150f7b2d2b3ec20a8f84}{set\-Acceleration\-Data} (\hyperlink{structEpos2MotorController_1_1accelerationData}{acceleration\-Data} $\ast$parameter)
\begin{DoxyCompactList}\small\item\em set all Data restricting the acceleration into the E\-P\-O\-S2. \end{DoxyCompactList}\item 
int \hyperlink{classEpos2MotorController_a1ada66b97fd8437591696824080ce434}{get\-Acceleration\-Data} (\hyperlink{structEpos2MotorController_1_1accelerationData}{acceleration\-Data} $\ast$parameter)
\begin{DoxyCompactList}\small\item\em read out all Data restricting the acceleration from the E\-P\-O\-S2 \end{DoxyCompactList}\item 
int \hyperlink{classEpos2MotorController_a60d132d6d79c0b8d49eb5ed721aae790}{set\-Max\-R\-P\-M} (double max\-R\-P\-M)
\begin{DoxyCompactList}\small\item\em set the highest allowed angular velocity into the E\-P\-O\-S2. \end{DoxyCompactList}\item 
int \hyperlink{classEpos2MotorController_ae363c85bc1e9dbad81fd49b06d783ff9}{get\-Max\-R\-P\-M} (double $\ast$max\-R\-P\-M)
\begin{DoxyCompactList}\small\item\em read out the currently set highest allowed angular velocity from the E\-P\-O\-S2. \end{DoxyCompactList}\item 
int \hyperlink{classEpos2MotorController_a84b2544d4e3facf75ae12a526da2735d}{get\-Regulator\-Parameter} (\hyperlink{structEpos2MotorController_1_1regulator}{regulator} $\ast$parameter)
\begin{DoxyCompactList}\small\item\em read out all parameter of the regulators from the E\-P\-O\-S2 \end{DoxyCompactList}\item 
int \hyperlink{classEpos2MotorController_a42c80ac11a2d4dfcb4f75a573e017164}{set\-Regulator\-Parameter} (\hyperlink{structEpos2MotorController_1_1regulator}{regulator} $\ast$parameter)
\begin{DoxyCompactList}\small\item\em set all parameter of the regulators into the E\-P\-O\-S2. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{void $\ast$ \hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}}\label{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}

\begin{DoxyCompactList}\small\item\em the device handle for the communication with the E\-P\-O\-S2 \end{DoxyCompactList}\item 
char $\ast$ \hyperlink{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}{node\-Str}
\begin{DoxyCompactList}\small\item\em this appears in front of a message published with R\-O\-S. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Types}
\begin{DoxyCompactItemize}
\item 
enum \{ \\*
{\bfseries debug}, 
{\bfseries info}, 
{\bfseries warn}, 
{\bfseries error}, 
\\*
{\bfseries fatal}
 \}
\begin{DoxyCompactList}\small\item\em all possible internal Errorlevel for a published message \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{classEpos2MotorController_a2ff727bd7ad81302c2feaaf297d888ae}{set\-Spin} (int reverse)
\begin{DoxyCompactList}\small\item\em set the positive direction of movement into the E\-P\-O\-S2. \end{DoxyCompactList}\item 
int \hyperlink{classEpos2MotorController_a8eb9d184e96079a5a995776cf3a453f2}{set\-Dimension\-And\-Notation} ()
\begin{DoxyCompactList}\small\item\em set how the numbers sending to the E\-P\-O\-S2 will be interpreted. \end{DoxyCompactList}\item 
void \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{error\-Output} (std\-::string error\-Text, int error\-Level=info, long int error\-Bit=1, unsigned int error\-Code=0)
\begin{DoxyCompactList}\small\item\em puts out a text message into ros standard output. \end{DoxyCompactList}\item 
int \hyperlink{classEpos2MotorController_a6a3f76a6ed867ed6847d9ebac01136ea}{init\-Communication} (std\-::string port, unsigned long baudrate, unsigned long timeout)
\begin{DoxyCompactList}\small\item\em build up the communication to a plugged E\-P\-O\-S2. \end{DoxyCompactList}\item 
int \hyperlink{classEpos2MotorController_a8fc2ecc7f9b6398382a96c760dace71a}{error\-If\-Not\-Bigger\-Zero} (double number, std\-::string var\-Name)
\begin{DoxyCompactList}\small\item\em checks if a given number is positive and nonzero. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{struct \\*
\hyperlink{structEpos2MotorController_1_1epos2Settings}{Epos2\-Motor\-Controller\-::epos2\-Settings} \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2\-Motor\-Set}}\label{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}

\begin{DoxyCompactList}\small\item\em Settings for the E\-P\-O\-S2. \end{DoxyCompactList}\item 
\hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060c}{Epos\-State} \hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state}
\begin{DoxyCompactList}\small\item\em the state inside this class depending on the state of the E\-P\-O\-S2 \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
E\-P\-O\-S2-\/\-Motor\-Controller-\/\-Class. 

It's used to control one E\-P\-O\-S2. 

Definition at line 22 of file Epos2\-Motor\-Controller.\-h.



\subsection{Member Enumeration Documentation}
\hypertarget{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060c}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!Epos\-State@{Epos\-State}}
\index{Epos\-State@{Epos\-State}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{Epos\-State}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf Epos2\-Motor\-Controller\-::\-Epos\-State}}}\label{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060c}


internal state of the Motor\-Controller-\/\-Object with respect to the state of the E\-P\-O\-S2 

\begin{Desc}
\item[Enumerator\-: ]\par
\begin{description}
\index{enabled@{enabled}!Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}}\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!enabled@{enabled}}\item[{\em 
\hypertarget{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060cae6493e2426163b114bea951ab9a419d5}{enabled}\label{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060cae6493e2426163b114bea951ab9a419d5}
}]E\-P\-O\-S2 is ready for driving. \index{disabled@{disabled}!Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}}\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!disabled@{disabled}}\item[{\em 
\hypertarget{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060caf0eea74682d3d3f21bec6e5b376cf443}{disabled}\label{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060caf0eea74682d3d3f21bec6e5b376cf443}
}]E\-P\-O\-S2 is started but not ready for driving. Changing of the most Settings in the E\-P\-O\-S2 only possible in this mode. \index{quickstop@{quickstop}!Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}}\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!quickstop@{quickstop}}\item[{\em 
\hypertarget{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060caa83d02e81212676710b3c6d97cb30119}{quickstop}\label{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060caa83d02e81212676710b3c6d97cb30119}
}]Safety brake. E\-P\-O\-S2 is started and stop the motor. \index{reset@{reset}!Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}}\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!reset@{reset}}\item[{\em 
\hypertarget{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060cae80551bbe5d91631014d56926de2d402}{reset}\label{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060cae80551bbe5d91631014d56926de2d402}
}]before deleting Faults you had to reset all E\-P\-O\-S2. no corresponding state in E\-P\-O\-S2. \index{fault@{fault}!Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}}\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!fault@{fault}}\item[{\em 
\hypertarget{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060ca9c2b33ebbe5a72ad6d09d6af6531237c}{fault}\label{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060ca9c2b33ebbe5a72ad6d09d6af6531237c}
}]no movement is possible. A text message with detail infos will be generated \begin{DoxySeeAlso}{See Also}
\hyperlink{classEpos2MotorController_a481615a590e6d1c6bf6c39c426e6d9a6}{test\-For\-Errors\-And\-Print()} 
\end{DoxySeeAlso}
\index{unknown@{unknown}!Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}}\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!unknown@{unknown}}\item[{\em 
\hypertarget{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060cad38c41836bbe157863e3eae0d308b7ca}{unknown}\label{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060cad38c41836bbe157863e3eae0d308b7ca}
}]couldn't read state. Maybe no connection to the E\-P\-O\-S2. \end{description}
\end{Desc}



Definition at line 62 of file Epos2\-Motor\-Controller.\-h.


\begin{DoxyCode}
        \{
            \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060cae6493e2426163b114bea951ab9a419d5}{enabled}, 
            \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060caf0eea74682d3d3f21bec6e5b376cf443}{disabled},   
            \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060caa83d02e81212676710b3c6d97cb30119}{quickstop}, 
            \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060cae80551bbe5d91631014d56926de2d402}{reset}, 
            \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060ca9c2b33ebbe5a72ad6d09d6af6531237c}{fault}, 
            \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060cad38c41836bbe157863e3eae0d308b7ca}{unknown}  
        \};
\end{DoxyCode}
\hypertarget{classEpos2MotorController_a5404c60266e24bb6c0ce60153ddcb774}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!Type@{Type}}
\index{Type@{Type}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{Type}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf Epos2\-Motor\-Controller\-::\-Type}}}\label{classEpos2MotorController_a5404c60266e24bb6c0ce60153ddcb774}


possible Types of Data in the Parameter structures. 

Equation in c++ data Types \begin{Desc}
\item[Enumerator\-: ]\par
\begin{description}
\index{u\-Short\-Int@{u\-Short\-Int}!Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}}\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!u\-Short\-Int@{u\-Short\-Int}}\item[{\em 
\hypertarget{classEpos2MotorController_a5404c60266e24bb6c0ce60153ddcb774a2b4b83649b11351ce20e5f3db7dd19f6}{u\-Short\-Int}\label{classEpos2MotorController_a5404c60266e24bb6c0ce60153ddcb774a2b4b83649b11351ce20e5f3db7dd19f6}
}]unsigned short int \index{u\-Int@{u\-Int}!Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}}\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!u\-Int@{u\-Int}}\item[{\em 
\hypertarget{classEpos2MotorController_a5404c60266e24bb6c0ce60153ddcb774a7cd8c8c80092885f086841058f4520a9}{u\-Int}\label{classEpos2MotorController_a5404c60266e24bb6c0ce60153ddcb774a7cd8c8c80092885f086841058f4520a9}
}]unsigned int \index{u\-Long\-Int@{u\-Long\-Int}!Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}}\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!u\-Long\-Int@{u\-Long\-Int}}\item[{\em 
\hypertarget{classEpos2MotorController_a5404c60266e24bb6c0ce60153ddcb774ae8b4415995e33e0fdb3318c2bb0ec1fc}{u\-Long\-Int}\label{classEpos2MotorController_a5404c60266e24bb6c0ce60153ddcb774ae8b4415995e33e0fdb3318c2bb0ec1fc}
}]unsigned long int \index{double\-T@{double\-T}!Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}}\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!double\-T@{double\-T}}\item[{\em 
\hypertarget{classEpos2MotorController_a5404c60266e24bb6c0ce60153ddcb774a6560d2c46b97b38b3c8db72e25563fd2}{double\-T}\label{classEpos2MotorController_a5404c60266e24bb6c0ce60153ddcb774a6560d2c46b97b38b3c8db72e25563fd2}
}]double \end{description}
\end{Desc}



Definition at line 51 of file Epos2\-Motor\-Controller.\-h.


\begin{DoxyCode}
        \{
            \hyperlink{classEpos2MotorController_a5404c60266e24bb6c0ce60153ddcb774a2b4b83649b11351ce20e5f3db7dd19f6}{uShortInt}, 
            \hyperlink{classEpos2MotorController_a5404c60266e24bb6c0ce60153ddcb774a7cd8c8c80092885f086841058f4520a9}{uInt},   
            \hyperlink{classEpos2MotorController_a5404c60266e24bb6c0ce60153ddcb774ae8b4415995e33e0fdb3318c2bb0ec1fc}{uLongInt},   
            \hyperlink{classEpos2MotorController_a5404c60266e24bb6c0ce60153ddcb774a6560d2c46b97b38b3c8db72e25563fd2}{doubleT}  
        \};
\end{DoxyCode}


\subsection{Constructor \& Destructor Documentation}
\hypertarget{classEpos2MotorController_a17d3eddbf93f2fa7622ab734a6c8e615}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}}
\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{Epos2\-Motor\-Controller}]{\setlength{\rightskip}{0pt plus 5cm}Epos2\-Motor\-Controller\-::\-Epos2\-Motor\-Controller (
\begin{DoxyParamCaption}
\item[{int}]{node, }
\item[{int}]{reverse\-Node, }
\item[{std\-::string}]{port, }
\item[{unsigned long}]{timeout = {\ttfamily 0}, }
\item[{unsigned long}]{baudrate = {\ttfamily 0}}
\end{DoxyParamCaption}
)}}\label{classEpos2MotorController_a17d3eddbf93f2fa7622ab734a6c8e615}


Constructor of a Motor\-Controller Object to build up a new communication. 

Only use once for a bunch of a E\-P\-O\-S2 connected among themselves by C\-A\-N.


\begin{DoxyParams}{Parameters}
{\em node} & the internal node number of the E\-P\-O\-S2 you want to connect to \\
\hline
{\em reverse\-Node} & if it's 1 the positive direction of movement will be switched \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See Also}
\hyperlink{classEpos2MotorController_a2ff727bd7ad81302c2feaaf297d888ae}{set\-Spin()} 
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
{\em port} & the name of the port where the E\-P\-O\-S2 is connected (U\-S\-B0, U\-S\-B1, ... or /dev/tty\-S0, /dev/tty\-S1, ...) \\
\hline
{\em timeout} & \mbox{[}ms\mbox{]} If there is no response from the E\-P\-O\-S2 within this time, you will get a communication error. If it's zero or not set, a value of 750 will be used. \\
\hline
{\em baudrate} & \mbox{[}bit/s\mbox{]} the frequency for the communication. If it's not set or zero, it will be set to 1000000 (U\-S\-B) or 115200 (R\-S232 -\/ Serial) \\
\hline
\end{DoxyParams}


Definition at line 35 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node} = nodeNr;

    \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_adf387ce695bf432caace5e216dda3429}{gearRatio} = 0;

    \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_abf2ed391ef59f5d99d7e6a9300f59ac3}{master} = 1;

    \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_a7bc89f766fbe9abcb503572714422658}{maxRotationPerMinute} = 0;
    \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_af14c93f519f8ecee21ab4eddfb2a2230}{reverse} = reverseNode;

    \textcolor{comment}{//ROS\_ERROR("port: %s", port);}

    \textcolor{keywordflow}{if} ( !(\hyperlink{classEpos2MotorController_a6a3f76a6ed867ed6847d9ebac01136ea}{initCommunication}(port, baudrate, timeout)) ) \{
        \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"get device-handle - not valid. Please try
       again."}, fatal);
    \} \textcolor{keywordflow}{else} \{
        \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"constructor - can't get a connection"}, debug);
    \}

\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_a85702068308f7694af8caf78a599ba31}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}}
\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{Epos2\-Motor\-Controller}]{\setlength{\rightskip}{0pt plus 5cm}Epos2\-Motor\-Controller\-::\-Epos2\-Motor\-Controller (
\begin{DoxyParamCaption}
\item[{int}]{node, }
\item[{int}]{reverse\-Node, }
\item[{void $\ast$}]{new\-Devhandle}
\end{DoxyParamCaption}
)}}\label{classEpos2MotorController_a85702068308f7694af8caf78a599ba31}


Constructor of a Motor\-Controller Object with a given communication handler. 


\begin{DoxyParams}{Parameters}
{\em node} & the internal node number of the E\-P\-O\-S2 you want to connect to \\
\hline
{\em reverse\-Node} & if it's 1 the positive direction of movement will be switched \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See Also}
\hyperlink{classEpos2MotorController_a2ff727bd7ad81302c2feaaf297d888ae}{set\-Spin()} 
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
{\em new\-Devhandle} & a device handle from another E\-P\-O\-S2 connected on the same wire (U\-S\-B or R\-S232; among themselves the E\-P\-O\-S2 should be connected over C\-A\-N) \\
\hline
\end{DoxyParams}


Definition at line 14 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node} = nodeNr;

    \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_adf387ce695bf432caace5e216dda3429}{gearRatio} = 0;

    \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_abf2ed391ef59f5d99d7e6a9300f59ac3}{master} = 0;

    \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_a7bc89f766fbe9abcb503572714422658}{maxRotationPerMinute} = 0;

    \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_af14c93f519f8ecee21ab4eddfb2a2230}{reverse} = reverseNode;

    \textcolor{keywordflow}{if} (newDevhandle != 0) \{
        this->\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle} = newDevhandle;
        \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"constructor - devhandle is valid"}, debug);
    \} \textcolor{keywordflow}{else} \{
        \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"new device-handle - not valid. Please try
       again."}, fatal);
    \}

\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_a897a1929a53a5c5211e925eab8792c90}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!$\sim$\-Epos2\-Motor\-Controller@{$\sim$\-Epos2\-Motor\-Controller}}
\index{$\sim$\-Epos2\-Motor\-Controller@{$\sim$\-Epos2\-Motor\-Controller}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{$\sim$\-Epos2\-Motor\-Controller}]{\setlength{\rightskip}{0pt plus 5cm}Epos2\-Motor\-Controller\-::$\sim$\-Epos2\-Motor\-Controller (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classEpos2MotorController_a897a1929a53a5c5211e925eab8792c90}


Release the E\-P\-O\-S2. 

All E\-P\-O\-S2 will be set into disable state. Only the E\-P\-O\-S2 which build up the communication (\char`\"{}master\char`\"{}) release also the device. Maybe it's not a good idea to release the master before the other E\-P\-O\-S2(s) connected over C\-A\-N to this master. 

Definition at line 56 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} errorCode=0;
    \textcolor{keywordtype}{int} bit=0;

    \hyperlink{classEpos2MotorController_ad58ad9fe38c72ce0d457a286973f8a99}{disableEpos2}();

    \textcolor{keywordflow}{if} (\hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_abf2ed391ef59f5d99d7e6a9300f59ac3}{master} == 1) \{
        \textcolor{keywordflow}{if} (\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle} != 0) \{
            bit = VCS\_CloseDevice(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, &errorCode);
            \textcolor{keywordflow}{if} (!bit) \{\hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"Can't release the Epos2-Device"},
       error, bit, errorCode);\}
        \} \textcolor{keywordflow}{else} \{
            bit = VCS\_CloseAllDevices(&errorCode);
            \textcolor{keywordflow}{if} (!bit) \{\hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"can't disconnect a Epos2-Device,
       because no Epos2 is connected"}, debug, bit, errorCode);\}
        \}
    \}

    \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"Epos2MotorController closed"}, info);

\}
\end{DoxyCode}


\subsection{Member Function Documentation}
\hypertarget{classEpos2MotorController_a4f3a4529154e01acb6a15ff94d5c9000}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!activate\-Profile\-Velocity@{activate\-Profile\-Velocity}}
\index{activate\-Profile\-Velocity@{activate\-Profile\-Velocity}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{activate\-Profile\-Velocity}]{\setlength{\rightskip}{0pt plus 5cm}int Epos2\-Motor\-Controller\-::activate\-Profile\-Velocity (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classEpos2MotorController_a4f3a4529154e01acb6a15ff94d5c9000}


change the Operation\-Mode of the E\-P\-O\-S2 into Profile\-Velocity\-Mode and set the Motion\-Profile to sin$^\wedge$2-\/ramp 

\begin{DoxyReturn}{Returns}
1 if successful otherwise 0 
\end{DoxyReturn}


Definition at line 234 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{int} bit=0, j=0;
    \textcolor{keywordtype}{char} mode = 0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} errorCode=0, bytesWritten;
    \textcolor{keywordtype}{short} \textcolor{keywordtype}{int} value = 1;

    bit = VCS\_SetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , 0x6086, 0x00, &value, 1, &bytesWritten, &errorCode);
    \textcolor{keywordflow}{if} (!bit) \{
        \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"set MotionProfileType to sin^2-ramp"}, error, 
      bit, errorCode);
    \}

    \textcolor{keywordflow}{do} \{
        bit = VCS\_SetOperationMode(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}
      .\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}, OMD\_PROFILE\_VELOCITY\_MODE, &errorCode);
        \textcolor{keywordflow}{if} (!bit) \{\hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"setting Mode to ProfileVelocity -
       not possible"}, error, bit, errorCode);\}

        j++;

        bit = VCS\_GetOperationMode(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}
      .\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}, &mode, &errorCode);
        \textcolor{keywordflow}{if} (!bit) \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"unable to read OperationMode"}, info, bit, 
      errorCode);
        \} \textcolor{keywordflow}{else} \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"read Mode"}, info, mode);
        \}
    \} \textcolor{keywordflow}{while} (mode != OMD\_PROFILE\_VELOCITY\_MODE && j < 4);

    \textcolor{keywordflow}{if} (mode == OMD\_PROFILE\_VELOCITY\_MODE) \{

        j=0;
        \textcolor{keywordflow}{do} \{
            bit = VCS\_ActivateProfileVelocityMode(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, 
      \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}, &errorCode);
            j++;
        \} \textcolor{keywordflow}{while} (bit == 0 && j < 4);

        \textcolor{keywordflow}{if} (bit == 0) \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"can't activate ProfilVelocityMode"}, error, 
      bit, errorCode);
            \textcolor{keywordflow}{return} 0;
        \} \textcolor{keywordflow}{else} \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"activate ProfileVelocityMode successful"});
            \textcolor{keywordflow}{return} 1;
        \}

    \} \textcolor{keywordflow}{else} \{

        \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"setting Mode to ProfileVelocity (unknown error)
       Mode"}, error, mode);
        \textcolor{keywordflow}{return} 0;
    \}

\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_a1b97f5c8fe0c7e2ff3256334c19b7a39}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!change\-Rotation\-Per\-Minute@{change\-Rotation\-Per\-Minute}}
\index{change\-Rotation\-Per\-Minute@{change\-Rotation\-Per\-Minute}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{change\-Rotation\-Per\-Minute}]{\setlength{\rightskip}{0pt plus 5cm}int Epos2\-Motor\-Controller\-::change\-Rotation\-Per\-Minute (
\begin{DoxyParamCaption}
\item[{double}]{target\-Velocity\-R\-P\-M}
\end{DoxyParamCaption}
)}}\label{classEpos2MotorController_a1b97f5c8fe0c7e2ff3256334c19b7a39}


set a target angular velocity for this E\-P\-O\-S2. 


\begin{DoxyParams}{Parameters}
{\em target\-Velocity\-R\-P\-M} & \mbox{[}rev/min\mbox{]} angular velocity target of the wheel (not on motor side of the gear) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if successful otherwise 0 
\end{DoxyReturn}


Definition at line 284 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{int} bit=0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} errorCode=0;
    \textcolor{keywordtype}{double} absoluteTargetVelocityRPM = fabs(targetVelocityRPM);

    \textcolor{keywordflow}{if} ( \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_a7bc89f766fbe9abcb503572714422658}{maxRotationPerMinute} >=
       absoluteTargetVelocityRPM ) \{
        \textcolor{keywordflow}{if} (absoluteTargetVelocityRPM < 0.2) \{  \textcolor{comment}{//stop motor}
            bit = VCS\_HaltVelocityMovement(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}
      .\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}, &errorCode);
            \textcolor{keywordflow}{if} (!bit) \{
                \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"stop Motor"}, error, bit, errorCode);
                \textcolor{keywordflow}{return} 0;
            \} \textcolor{keywordflow}{else} \{
                \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"stop motor"});
                \textcolor{keywordflow}{return} 1;
            \}
        \} \textcolor{keywordflow}{else} \{    \textcolor{comment}{//start motor with gearRatio*rpm}
            bit = VCS\_MoveWithVelocity(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}
      .\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}, (\textcolor{keywordtype}{long} \textcolor{keywordtype}{int}) (targetVelocityRPM * 1000 * \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.
      \hyperlink{structEpos2MotorController_1_1epos2Settings_adf387ce695bf432caace5e216dda3429}{gearRatio}), &errorCode);
            \textcolor{keywordtype}{char} velString[30];
            sprintf(velString, \textcolor{stringliteral}{"set Speed to %.3f rpm"}, targetVelocityRPM);

            \textcolor{keywordflow}{if} (!bit) \{
                \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}( velString, error, bit, errorCode);
                \textcolor{keywordflow}{return} 0;
            \} \textcolor{keywordflow}{else} \{
                \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(velString);
                \textcolor{keywordflow}{return} 1;
            \}
        \}\textcolor{comment}{//end rpm==0}
    \} \textcolor{keywordflow}{else} \{
        ROS\_WARN(\textcolor{stringliteral}{"speed wasn't changed. Absolute Values greater then the
       maximal velocity are not allowed."});
        \textcolor{keywordflow}{return} 0;
    \}\textcolor{comment}{//end maxRPM >= rpm}
\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_a07446045b12515427feda98fea36dab2}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!clear\-Fault@{clear\-Fault}}
\index{clear\-Fault@{clear\-Fault}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{clear\-Fault}]{\setlength{\rightskip}{0pt plus 5cm}int Epos2\-Motor\-Controller\-::clear\-Fault (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classEpos2MotorController_a07446045b12515427feda98fea36dab2}


Delete all errors in the Error history of this E\-P\-O\-S2. 

\begin{DoxyReturn}{Returns}
1 if successful otherwise 0 
\end{DoxyReturn}


Definition at line 96 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{int} bit=0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} errorCode=0;

    \textcolor{keywordflow}{if} (\hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} == \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060cae80551bbe5d91631014d56926de2d402}{reset}) \{
        bit = VCS\_ClearFault(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{
      node}, &errorCode);
    \} \textcolor{keywordflow}{else} \{
        ROS\_ERROR(\textcolor{stringliteral}{"EPOS2-Device was not reset. Please use resetDevice() first."}
      );
        bit = 1; \textcolor{comment}{//set, to get a new state...}
    \}

    \textcolor{keywordflow}{if} (!bit) \{
        \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"clear errors"}, error, bit, errorCode);
        \textcolor{keywordflow}{return} 0;
    \} \textcolor{keywordflow}{else} \{
        \hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} = \hyperlink{classEpos2MotorController_ac6c31e0dc57485aa817431b22627fc70}{getEpos2State}();
        \textcolor{keywordflow}{return} 1;
    \}
\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_ad58ad9fe38c72ce0d457a286973f8a99}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!disable\-Epos2@{disable\-Epos2}}
\index{disable\-Epos2@{disable\-Epos2}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{disable\-Epos2}]{\setlength{\rightskip}{0pt plus 5cm}int Epos2\-Motor\-Controller\-::disable\-Epos2 (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classEpos2MotorController_ad58ad9fe38c72ce0d457a286973f8a99}


set the E\-P\-O\-S2 into disable state 

\begin{DoxyReturn}{Returns}
1 if successful otherwise 0 
\end{DoxyReturn}


Definition at line 190 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{int} bit=0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} errorCode=0;

    \hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} = \hyperlink{classEpos2MotorController_ac6c31e0dc57485aa817431b22627fc70}{getEpos2State}();

    \textcolor{keywordflow}{if} (\hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} <= \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060caa83d02e81212676710b3c6d97cb30119}{quickstop}) \{
        VCS\_SetDisableState(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , &errorCode);
        \hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} = \hyperlink{classEpos2MotorController_ac6c31e0dc57485aa817431b22627fc70}{getEpos2State}();
    \}

    \textcolor{keywordflow}{if} (\hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} == \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060caf0eea74682d3d3f21bec6e5b376cf443}{disabled}) \{
        \textcolor{keywordflow}{return} 1;
    \} \textcolor{keywordflow}{else} \{
        \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"SetDisable"}, error, bit, errorCode);
        \textcolor{keywordflow}{return} 0;
    \}

\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_aeadc7a21fa6619a4104887f169b9d2fd}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!enable\-Epos2@{enable\-Epos2}}
\index{enable\-Epos2@{enable\-Epos2}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{enable\-Epos2}]{\setlength{\rightskip}{0pt plus 5cm}int Epos2\-Motor\-Controller\-::enable\-Epos2 (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classEpos2MotorController_aeadc7a21fa6619a4104887f169b9d2fd}


set the E\-P\-O\-S2 into enable state 

\begin{DoxyReturn}{Returns}
1 if successful otherwise 0 
\end{DoxyReturn}


Definition at line 169 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{int} bit=0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} errorCode=0;

    \hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} = \hyperlink{classEpos2MotorController_ac6c31e0dc57485aa817431b22627fc70}{getEpos2State}();

    \textcolor{keywordflow}{if} (\hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} <= \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060caa83d02e81212676710b3c6d97cb30119}{quickstop}) \{
        VCS\_SetEnableState(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , &errorCode);
        \hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} = \hyperlink{classEpos2MotorController_ac6c31e0dc57485aa817431b22627fc70}{getEpos2State}();
    \}

    \textcolor{keywordflow}{if} (\hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} == \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060cae6493e2426163b114bea951ab9a419d5}{enabled}) \{
        \textcolor{keywordflow}{return} 1;
    \} \textcolor{keywordflow}{else} \{
        \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"SetEnable"}, error, bit, errorCode);
        \textcolor{keywordflow}{return} 0;
    \}

\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_a8fc2ecc7f9b6398382a96c760dace71a}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!error\-If\-Not\-Bigger\-Zero@{error\-If\-Not\-Bigger\-Zero}}
\index{error\-If\-Not\-Bigger\-Zero@{error\-If\-Not\-Bigger\-Zero}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{error\-If\-Not\-Bigger\-Zero}]{\setlength{\rightskip}{0pt plus 5cm}int Epos2\-Motor\-Controller\-::error\-If\-Not\-Bigger\-Zero (
\begin{DoxyParamCaption}
\item[{double}]{number, }
\item[{std\-::string}]{var\-Name}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{classEpos2MotorController_a8fc2ecc7f9b6398382a96c760dace71a}


checks if a given number is positive and nonzero. 

if not an error will be send to ros output


\begin{DoxyParams}{Parameters}
{\em number} & the number which should be checked \\
\hline
{\em var\-Name} & this name will be published in the Error message if the number is negative or zero\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if not negative or zero otherwise 0 
\end{DoxyReturn}


Definition at line 902 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordflow}{if} (number > 0) \{
        \textcolor{keywordflow}{return} 1;
    \} \textcolor{keywordflow}{else} \{
        \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"Parameter "} + varName + \textcolor{stringliteral}{" isn't greater than
       zero. Please change it before running the EPOS2."}, error);
        \textcolor{keywordflow}{return} 0;
    \}
\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!error\-Output@{error\-Output}}
\index{error\-Output@{error\-Output}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{error\-Output}]{\setlength{\rightskip}{0pt plus 5cm}void Epos2\-Motor\-Controller\-::error\-Output (
\begin{DoxyParamCaption}
\item[{std\-::string}]{error\-Text, }
\item[{int}]{error\-Level = {\ttfamily info}, }
\item[{long int}]{error\-Bit = {\ttfamily 1}, }
\item[{unsigned int}]{error\-Code = {\ttfamily 0}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}


puts out a text message into ros standard output. 

the pattern is like this\-: \mbox{[}\%node\-Str\%\mbox{]} \%error\-Text\%\%error\-Str\% while \%error\-Text\% will be replaced by the given function parameter, \%node\-Str\% is a global member of this class with the name of the Node and \%error\-Str\% is a text message generated by the E\-P\-O\-S library when a error\-Bit unequal 1 or an error\-Code unequal 0 is given

\begin{DoxySeeAlso}{See Also}
\hyperlink{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}{node\-Str}
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
{\em error\-Text} & the message which should be printed \\
\hline
{\em error\-Level} & the R\-O\-S Error\-Level on which the message should be published \\
\hline
{\em error\-Bit} & just an integer. most functions of the E\-P\-O\-S library give back an integer value. \\
\hline
{\em error\-Code} & an error\-Code returned by a function of the E\-P\-O\-S library. \\
\hline
\end{DoxyParams}


Definition at line 799 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{int} bit=0;                  \textcolor{comment}{//control-bit for the return of functions}
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} maxStr=100;  \textcolor{comment}{//max stringsize}
    \textcolor{keywordtype}{char} errorInfo[maxStr];     \textcolor{comment}{//errorstring}
    \textcolor{keywordtype}{char} errorStr[200];

    \textcolor{keywordflow}{if} (errorBit != 1 || errorCode != 0) \{
        bit = VCS\_GetErrorInfo(errorCode, errorInfo, maxStr);   \textcolor{comment}{//get the
       ErrorString}
        \textcolor{keywordflow}{if} (bit) \{  \textcolor{comment}{//Output for known Errors}
            sprintf(errorStr, \textcolor{stringliteral}{" with Errorbit: %li & Error: %s (0x%x)"}, 
      errorBit, errorInfo, errorCode);
        \} \textcolor{keywordflow}{else} \{    \textcolor{comment}{//Output if there is no ErrorString}
            ROS\_ERROR(\textcolor{stringliteral}{"Can't read ErrorCode with the VCS\_GetErrorInfo-Function
       from the EPOS2-Library!"});
            sprintf(errorStr, \textcolor{stringliteral}{" with Errorbit: %li & Error: NO DESCRIPTION
       (0x%x)"}, errorBit, errorCode);
        \}
    \} \textcolor{keywordflow}{else} \{
        bit = 1;
        sprintf(errorStr,\textcolor{stringliteral}{""});
    \}

    \textcolor{keywordflow}{switch}(errorLevel) \{
    \textcolor{keywordflow}{case} debug: ROS\_DEBUG(\textcolor{stringliteral}{"[%s] %s%s"}, \hyperlink{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}{nodeStr}, errorText.c\_str(), 
      errorStr);
                \textcolor{keywordflow}{break};
    \textcolor{keywordflow}{case} info:  ROS\_INFO(\textcolor{stringliteral}{"[%s] %s%s"}, \hyperlink{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}{nodeStr}, errorText.c\_str(), 
      errorStr);
                \textcolor{keywordflow}{break};
    \textcolor{keywordflow}{case} warn:  ROS\_WARN(\textcolor{stringliteral}{"[%s] %s%s"}, \hyperlink{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}{nodeStr}, errorText.c\_str(), 
      errorStr);
                \textcolor{keywordflow}{break};
    \textcolor{keywordflow}{case} error: ROS\_ERROR(\textcolor{stringliteral}{"[%s] %s%s"}, \hyperlink{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}{nodeStr}, errorText.c\_str(), 
      errorStr);
                \textcolor{keywordflow}{break};
    \textcolor{keywordflow}{case} fatal: ROS\_FATAL(\textcolor{stringliteral}{"[%s] %s%s"}, \hyperlink{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}{nodeStr}, errorText.c\_str(), 
      errorStr);
                \textcolor{keywordflow}{break};
    \textcolor{keywordflow}{default}:    ROS\_WARN(\textcolor{stringliteral}{"Unknown Errorlevel: [%s] %s%s"}, \hyperlink{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}{nodeStr}, 
      errorText.c\_str(), errorStr);
                \textcolor{keywordflow}{break};
    \}
\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_a07b5def07609a91cba8a1977f6436c0a}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!get\-Absolute\-Position@{get\-Absolute\-Position}}
\index{get\-Absolute\-Position@{get\-Absolute\-Position}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{get\-Absolute\-Position}]{\setlength{\rightskip}{0pt plus 5cm}double Epos2\-Motor\-Controller\-::get\-Absolute\-Position (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classEpos2MotorController_a07b5def07609a91cba8a1977f6436c0a}


read out the current position value depending on the start position. 

convert the encoder ticks into \mbox{[}rev/min\mbox{]} of the wheel (after gear)

\begin{DoxyReturn}{Returns}
\mbox{[}rev/min\mbox{]} Rotations count from start position 
\end{DoxyReturn}


Definition at line 353 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{int} bit=0;
    \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} value;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} errorCode=0;

    bit = VCS\_GetPositionIs(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , &value, &errorCode);
    \textcolor{keywordflow}{if} (!bit) \{\hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"Can't read actual positionValue"}, warn, 
      bit, errorCode);\}

    \textcolor{comment}{//rotations = ((double)(value)) / (2000 * epos2MotorSet.gearRatio);}

    \textcolor{keywordflow}{return} ((\textcolor{keywordtype}{double})(value)) * 0.0005 / \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_adf387ce695bf432caace5e216dda3429}{gearRatio}
      ;
\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_a1ada66b97fd8437591696824080ce434}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!get\-Acceleration\-Data@{get\-Acceleration\-Data}}
\index{get\-Acceleration\-Data@{get\-Acceleration\-Data}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{get\-Acceleration\-Data}]{\setlength{\rightskip}{0pt plus 5cm}int Epos2\-Motor\-Controller\-::get\-Acceleration\-Data (
\begin{DoxyParamCaption}
\item[{{\bf acceleration\-Data} $\ast$}]{parameter}
\end{DoxyParamCaption}
)}}\label{classEpos2MotorController_a1ada66b97fd8437591696824080ce434}


read out all Data restricting the acceleration from the E\-P\-O\-S2 


\begin{DoxyParams}{Parameters}
{\em $\ast$parameter} & structure for all relevant acceleration data \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if successful otherwise 0 
\end{DoxyReturn}


Definition at line 541 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{int} bit = 0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} errorCode, bytesRead;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} value, value2;

    \textcolor{comment}{//init}
    parameter->maxAcceleration = 0.51;
    parameter->profileAcceleration = 0.4;
    parameter->profileDeceleration = 0.4;
    parameter->quickstopDeceleration = 0.5;

    \textcolor{comment}{//getting-functions-units are [rev/(min * s)] and output-units are
       [m/(s^2)]}

    bit = VCS\_GetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , 0x60c5, 0x00, &value, 2, &bytesRead, &errorCode);
    \textcolor{keywordflow}{if} (!bit) \{
        \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"get max Acceleration"}, error, bit, errorCode);
    \} \textcolor{keywordflow}{else} \{
        parameter->maxAcceleration = ((double) value) * \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}
      .\hyperlink{structEpos2MotorController_1_1epos2Settings_ab7dfe30a4a13813163437d4d54fa053d}{wheelPerimeter} / (60 * \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_adf387ce695bf432caace5e216dda3429}{gearRatio}
      );
    \}

    bit = VCS\_GetVelocityProfile(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}
      .\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}, &value, &value2, &errorCode);
    \textcolor{keywordflow}{if} (!bit) \{
        \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"get velocity profile acceleration and
       deceleration"}, error, bit, errorCode);
    \} \textcolor{keywordflow}{else} \{
        parameter->profileAcceleration = ((double) value) * \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}
      .\hyperlink{structEpos2MotorController_1_1epos2Settings_ab7dfe30a4a13813163437d4d54fa053d}{wheelPerimeter} / (60 * \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_adf387ce695bf432caace5e216dda3429}{gearRatio}
      );
        parameter->profileDeceleration = ((double) value2) * \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}
      .\hyperlink{structEpos2MotorController_1_1epos2Settings_ab7dfe30a4a13813163437d4d54fa053d}{wheelPerimeter} / (60 * \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_adf387ce695bf432caace5e216dda3429}{gearRatio}
      );
    \}

    bit = VCS\_GetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , 0x6085, 0x00, &value, 2, &bytesRead, &errorCode);
    \textcolor{keywordflow}{if} (!bit) \{
        \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"get max QuickStopDeceleration"}, error, bit, 
      errorCode);
    \} \textcolor{keywordflow}{else} \{
        parameter->quickstopDeceleration = ((double) value) * \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}
      .\hyperlink{structEpos2MotorController_1_1epos2Settings_ab7dfe30a4a13813163437d4d54fa053d}{wheelPerimeter} / (60 * \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_adf387ce695bf432caace5e216dda3429}{gearRatio}
      );
    \}

    \textcolor{keywordflow}{return} 1;
\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_ac6c31e0dc57485aa817431b22627fc70}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!get\-Epos2\-State@{get\-Epos2\-State}}
\index{get\-Epos2\-State@{get\-Epos2\-State}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{get\-Epos2\-State}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Epos2\-Motor\-Controller\-::\-Epos\-State} Epos2\-Motor\-Controller\-::get\-Epos2\-State (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classEpos2MotorController_ac6c31e0dc57485aa817431b22627fc70}


read out the state of the E\-P\-O\-S2 state machine 

\begin{DoxyReturn}{Returns}
internal state in the Epos2\-Motor\-Controller\-Class 
\end{DoxyReturn}


Definition at line 320 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{int} bit=0;
    \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060c}{EposState} temp = \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060cad38c41836bbe157863e3eae0d308b7ca}{unknown};
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} errorCode=0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} tempState=0;

    bit=VCS\_GetState(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}, &
      tempState, &errorCode);

    \textcolor{keywordflow}{if} (!bit) \{
        \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"read State of Node"}, error, 0, errorCode);
        \textcolor{keywordflow}{return} \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060cad38c41836bbe157863e3eae0d308b7ca}{unknown};
    \} \textcolor{keywordflow}{else} \{

        \textcolor{keywordflow}{switch} (tempState) \{
            \textcolor{keywordflow}{case} ST\_ENABLED:    temp = \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060cae6493e2426163b114bea951ab9a419d5}{enabled};
                                \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"getState: enabled"}, 
      debug);
                                \textcolor{keywordflow}{break};
            \textcolor{keywordflow}{case} ST\_DISABLED:   temp = \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060caf0eea74682d3d3f21bec6e5b376cf443}{disabled};
                                \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"getState: disabled"}, 
      debug);
                                \textcolor{keywordflow}{break};
            \textcolor{keywordflow}{case} ST\_QUICKSTOP:  temp = \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060caa83d02e81212676710b3c6d97cb30119}{quickstop};
                                \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"getState: quickstop"}, 
      debug);
                                \textcolor{keywordflow}{break};
            \textcolor{keywordflow}{case} ST\_FAULT:      temp = \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060ca9c2b33ebbe5a72ad6d09d6af6531237c}{fault};
                                \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"getState: fault"}, debug
      );
                                \textcolor{keywordflow}{break};
        \}

        \textcolor{keywordflow}{return} temp;
    \}
\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_a43b5c84e3d2c891a98fae2c159d0a112}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!get\-Gear\-Data@{get\-Gear\-Data}}
\index{get\-Gear\-Data@{get\-Gear\-Data}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{get\-Gear\-Data}]{\setlength{\rightskip}{0pt plus 5cm}int Epos2\-Motor\-Controller\-::get\-Gear\-Data (
\begin{DoxyParamCaption}
\item[{{\bf gear\-Data} $\ast$}]{parameter}
\end{DoxyParamCaption}
)}}\label{classEpos2MotorController_a43b5c84e3d2c891a98fae2c159d0a112}


read out all Data of the gear from the E\-P\-O\-S2 


\begin{DoxyParams}{Parameters}
{\em $\ast$parameter} & structure for all relevant gear data \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if successful otherwise 0 
\end{DoxyReturn}


Definition at line 397 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{int} bit=0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} errorCode=0, bytesRead=0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} value;

    \textcolor{comment}{//init}
    parameter->denominator = \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_af648530b886ebd8176997645c99aa35b}{gearDenomiantor}
      ;
    parameter->numerator = \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_a1524dd1ea0ca97addfa48ec2ba983c3e}{gearNumerator}
      ;
    parameter->maxRPM = 1;

    \hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} = \hyperlink{classEpos2MotorController_ac6c31e0dc57485aa817431b22627fc70}{getEpos2State}();

    \textcolor{keywordflow}{if} (\hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} <= \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060ca9c2b33ebbe5a72ad6d09d6af6531237c}{fault}) \{

        \textcolor{comment}{/*bit = VCS\_GetObject(devhandle, epos2MotorSet.node, 0x2230, 0x01,
       &(parameter->numerator), 4, &bytesRead, &errorCode);}
\textcolor{comment}{        if (!bit) \{ errorOutput("couldn't read Gear-Numerator", error, bit,
       errorCode);\}}
\textcolor{comment}{}
\textcolor{comment}{        bit = VCS\_GetObject(devhandle, epos2MotorSet.node, 0x2230, 0x02,
       &(parameter->denominator), 2, &bytesRead, &errorCode);}
\textcolor{comment}{        if (!bit) \{ errorOutput("couldn't read Gear-Denominator", error, bit,
       errorCode);\}*/}

        bit = VCS\_GetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , 0x2230, 0x03, &value, 4, &bytesRead, &errorCode);
        \textcolor{keywordflow}{if} (!bit) \{ \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"couldn't read max RPM of Gear"}, 
      error, bit, errorCode);\}

        parameter->maxRPM = (double)value;

        \textcolor{keywordflow}{return} 1;
    \} \textcolor{keywordflow}{else} \{
        \textcolor{keywordflow}{return} 0;
    \}
\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_ae363c85bc1e9dbad81fd49b06d783ff9}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!get\-Max\-R\-P\-M@{get\-Max\-R\-P\-M}}
\index{get\-Max\-R\-P\-M@{get\-Max\-R\-P\-M}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{get\-Max\-R\-P\-M}]{\setlength{\rightskip}{0pt plus 5cm}int Epos2\-Motor\-Controller\-::get\-Max\-R\-P\-M (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{max\-R\-P\-M}
\end{DoxyParamCaption}
)}}\label{classEpos2MotorController_ae363c85bc1e9dbad81fd49b06d783ff9}


read out the currently set highest allowed angular velocity from the E\-P\-O\-S2. 


\begin{DoxyParams}{Parameters}
{\em $\ast$max\-R\-P\-M} & current highest allowed angular velocity \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if successful otherwise 0 
\end{DoxyReturn}


Definition at line 605 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{int} bit=0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} errorCode=0, bytesRead=0;
    \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} value;

    *maxRPM = 0;
    \hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} = \hyperlink{classEpos2MotorController_ac6c31e0dc57485aa817431b22627fc70}{getEpos2State}();

    \textcolor{keywordflow}{if} (\hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} <= \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060ca9c2b33ebbe5a72ad6d09d6af6531237c}{fault}) \{

        bit = VCS\_GetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , 0x607f, 0x00, &value, 4, &bytesRead, &errorCode);
        \textcolor{keywordflow}{if} (!bit) \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"couldn't read max RPM of wheels"}, error, 
      bit, errorCode);
        \}

        *maxRPM = (double)value * 0.001 / \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_adf387ce695bf432caace5e216dda3429}{gearRatio}
      ;

        \textcolor{keywordflow}{return} 1;
    \} \textcolor{keywordflow}{else} \{
        \textcolor{keywordflow}{return} 0;
    \}
\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_a0b70bbbfed4fa0c78a9f15dfb593bb9f}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!get\-Motor\-Data@{get\-Motor\-Data}}
\index{get\-Motor\-Data@{get\-Motor\-Data}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{get\-Motor\-Data}]{\setlength{\rightskip}{0pt plus 5cm}int Epos2\-Motor\-Controller\-::get\-Motor\-Data (
\begin{DoxyParamCaption}
\item[{{\bf motor\-Data} $\ast$}]{parameter}
\end{DoxyParamCaption}
)}}\label{classEpos2MotorController_a0b70bbbfed4fa0c78a9f15dfb593bb9f}


read out all Data of the motor from the E\-P\-O\-S2 


\begin{DoxyParams}{Parameters}
{\em $\ast$parameter} & structure for all relevant motor data \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if successful otherwise 0 
\end{DoxyReturn}


Definition at line 464 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{int} bit=0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} bytesRead=0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} errorCode=0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} value;

    \hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} = \hyperlink{classEpos2MotorController_ac6c31e0dc57485aa817431b22627fc70}{getEpos2State}();

    \textcolor{keywordflow}{if} (\hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} <= \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060ca9c2b33ebbe5a72ad6d09d6af6531237c}{fault}) \{

        bit = VCS\_GetDcMotorParameter(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}
      .\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}, &(parameter->continuousCurrent), &(parameter->maxPeakCurrent), &(
      parameter->thermalTimeConstantWinding), &errorCode);
        \textcolor{keywordflow}{if} (bit != 0) \{
            ROS\_DEBUG(\textcolor{stringliteral}{"MotorData %s: NominalCurrent - %i, PeakCurrent - %i,
       ThermalTimeConstant - %i"}, \hyperlink{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}{nodeStr}, parameter->continuousCurrent, parameter
      ->maxPeakCurrent, parameter->thermalTimeConstantWinding);
        \} \textcolor{keywordflow}{else} \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"couldn't read DC-Motor parameter"}, warn, 
      bit, errorCode);
        \}

        bit = VCS\_GetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , 0x6410, 0x04, &value, 4, &bytesRead, &errorCode);
        \textcolor{keywordflow}{if} (bit != 0) \{
            ROS\_DEBUG(\textcolor{stringliteral}{"Maximum Velocity is %s: %li rpm"}, \hyperlink{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}{nodeStr}, 
      parameter->maxRPM);
        \} \textcolor{keywordflow}{else} \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"couldn't read maximum RPM of Motor"}, warn, 
      bit, errorCode);
        \}

        parameter->maxRPM = (double) value;

        \textcolor{keywordflow}{return} 1;
    \} \textcolor{keywordflow}{else} \{
        \textcolor{keywordflow}{return} 0;
    \}
\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_a84b2544d4e3facf75ae12a526da2735d}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!get\-Regulator\-Parameter@{get\-Regulator\-Parameter}}
\index{get\-Regulator\-Parameter@{get\-Regulator\-Parameter}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{get\-Regulator\-Parameter}]{\setlength{\rightskip}{0pt plus 5cm}int Epos2\-Motor\-Controller\-::get\-Regulator\-Parameter (
\begin{DoxyParamCaption}
\item[{{\bf regulator} $\ast$}]{parameter}
\end{DoxyParamCaption}
)}}\label{classEpos2MotorController_a84b2544d4e3facf75ae12a526da2735d}


read out all parameter of the regulators from the E\-P\-O\-S2 


\begin{DoxyParams}{Parameters}
{\em $\ast$parameter} & structure for all regulator gain and feedforward values \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if successful otherwise 0 
\end{DoxyReturn}


Definition at line 629 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{int} bit=0, bit1=0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} errorCode=0, bytesRead=0;

    \hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} = \hyperlink{classEpos2MotorController_ac6c31e0dc57485aa817431b22627fc70}{getEpos2State}();

    \textcolor{keywordflow}{if} (\hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} <= \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060ca9c2b33ebbe5a72ad6d09d6af6531237c}{fault}) \{

        bit = VCS\_GetPositionRegulatorGain(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}
      .\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}, &(*parameter).positionGain.p, &(*parameter).positionGain.i, &
      (*parameter).positionGain.d, &errorCode);
        \textcolor{keywordflow}{if} (bit != 0) \{
            ROS\_DEBUG(\textcolor{stringliteral}{"PositionGain read %s: P - %i, I - %i, D - %i"}, \hyperlink{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}{nodeStr}
      , (*parameter).positionGain.p, (*parameter).positionGain.i, (*parameter).
      positionGain.d);
        \} \textcolor{keywordflow}{else} \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"couldn't read Position Gain Values"}, warn, 
       bit, errorCode);
        \}

        bit = VCS\_GetPositionRegulatorFeedForward(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, 
      \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}, &(*parameter).positionFF.Velocity, &
      (*parameter).positionFF.Acceleration, &errorCode);
        \textcolor{keywordflow}{if} (bit != 0) \{
            ROS\_DEBUG(\textcolor{stringliteral}{"PositionFeedForward read %s: Velocity - %i, Acceleration
       - %i"}, \hyperlink{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}{nodeStr}, (*parameter).positionFF.Velocity, (*parameter).
      positionFF.Acceleration);
        \} \textcolor{keywordflow}{else} \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"couldn't read Position FeedForward Values"},
       warn,  bit, errorCode);
        \}

        bit = VCS\_GetVelocityRegulatorGain(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}
      .\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}, &(*parameter).velocityGain.p, &(*parameter).velocityGain.i, &
      errorCode);
        \textcolor{keywordflow}{if} (bit != 0) \{
            ROS\_DEBUG(\textcolor{stringliteral}{"VelocityGain read %s: P - %i, I - %i"}, \hyperlink{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}{nodeStr}, 
      (*parameter).velocityGain.p, (*parameter).velocityGain.i);
        \} \textcolor{keywordflow}{else} \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"couldn't read Velocity Gain Values"}, warn, 
      bit, errorCode);
        \}

        bit  = VCS\_GetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{
      node}, 0x60f9, 0x04, (\textcolor{keywordtype}{short} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} *) &(*parameter).velocityFF.Velocity, 2
      , &bytesRead, &errorCode);
        bit1 = VCS\_GetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{
      node}, 0x60f9, 0x05, (\textcolor{keywordtype}{short} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} *) &(*parameter).velocityFF.
      Acceleration, 2, &bytesRead, &errorCode);
        \textcolor{keywordflow}{if} (bit != 0 && bit1 !=0) \{
            ROS\_DEBUG(\textcolor{stringliteral}{"VelocityFeedForward read %s: Velocity - %i, Acceleration
       - %i"}, \hyperlink{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}{nodeStr}, (*parameter).velocityFF.Velocity, (*parameter).
      velocityFF.Acceleration);
        \} \textcolor{keywordflow}{else} \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"couldn't read Velocity FeedForward Values"},
       warn, bit, errorCode);
        \}

        bit = VCS\_GetCurrentRegulatorGain(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}
      .\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}, &(*parameter).currentGain.p, &(*parameter).currentGain.i, &errorCode)
      ;
        \textcolor{keywordflow}{if} (bit != 0) \{
            ROS\_DEBUG(\textcolor{stringliteral}{"CurrentGain read %s: P - %i, I - %i"}, \hyperlink{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}{nodeStr}, 
      (*parameter).currentGain.p, (*parameter).currentGain.i);
        \} \textcolor{keywordflow}{else} \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"couldn't read Current Gain Values"}, warn, 
      bit, errorCode);
        \}

        \textcolor{keywordflow}{return} 1;
    \} \textcolor{keywordflow}{else} \{
        \textcolor{keywordflow}{return} 0;
    \}
\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_a0c2778ab028417b907d7a55297ccbd4a}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!init@{init}}
\index{init@{init}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{init}]{\setlength{\rightskip}{0pt plus 5cm}void Epos2\-Motor\-Controller\-::init (
\begin{DoxyParamCaption}
\item[{double}]{max\-R\-P\-M, }
\item[{double}]{wheel\-Perimeter}
\end{DoxyParamCaption}
)}}\label{classEpos2MotorController_a0c2778ab028417b907d7a55297ccbd4a}


calls a few set-\/functions, store the settings in the E\-P\-O\-S2 and enable the Device. 


\begin{DoxyParams}{Parameters}
{\em max\-R\-P\-M} & \mbox{[}rev/min\mbox{]} highest allowed angular velocity for this E\-P\-O\-S2 \\
\hline
{\em wheel\-Perimeter} & \mbox{[}m\mbox{]} Perimeter of one wheel connected to this E\-P\-O\-S2\\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See Also}
\hyperlink{classEpos2MotorController_a2ff727bd7ad81302c2feaaf297d888ae}{set\-Spin()} 

\hyperlink{classEpos2MotorController_a8eb9d184e96079a5a995776cf3a453f2}{set\-Dimension\-And\-Notation()} 

\hyperlink{classEpos2MotorController_a0a5257b20692de37091544e6ed5f6aed}{set\-Motor\-Data()} 

\hyperlink{classEpos2MotorController_a6c806fba7028bed11d710c4f453869b1}{set\-Gear\-Data()} 

\hyperlink{classEpos2MotorController_aada27a05c4f5150f7b2d2b3ec20a8f84}{set\-Acceleration\-Data()} 

\hyperlink{classEpos2MotorController_a60d132d6d79c0b8d49eb5ed721aae790}{set\-Max\-R\-P\-M()} 

\hyperlink{classEpos2MotorController_a2e1ad71a3be2943ed7bffd743c4f1fad}{store\-Settings()} 
\end{DoxySeeAlso}


Definition at line 835 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordflow}{if} ( \hyperlink{classEpos2MotorController_ad58ad9fe38c72ce0d457a286973f8a99}{disableEpos2}() ) \{
        \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab7dfe30a4a13813163437d4d54fa053d}{wheelPerimeter} = 
      wheelPerimeter;

        \hyperlink{classEpos2MotorController_a2ff727bd7ad81302c2feaaf297d888ae}{setSpin}(\hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_af14c93f519f8ecee21ab4eddfb2a2230}{reverse});
        \hyperlink{classEpos2MotorController_a8eb9d184e96079a5a995776cf3a453f2}{setDimensionAndNotation}();

        gearData gearTemp = \{7000, 147, 2\};
        \hyperlink{classEpos2MotorController_a6c806fba7028bed11d710c4f453869b1}{setGearData}(&gearTemp);
        motorData motorTemp = \{5000, 0, 10, 7000\};
        \hyperlink{classEpos2MotorController_a0a5257b20692de37091544e6ed5f6aed}{setMotorData}(&motorTemp);
        accelerationData accTemp = \{0.5, 0.5, 0.6, 0.61\};
        \hyperlink{classEpos2MotorController_aada27a05c4f5150f7b2d2b3ec20a8f84}{setAccelerationData}(&accTemp);
        \hyperlink{classEpos2MotorController_a60d132d6d79c0b8d49eb5ed721aae790}{setMaxRPM}(maxRPM);

        \hyperlink{classEpos2MotorController_a2e1ad71a3be2943ed7bffd743c4f1fad}{storeSettings}();

        \hyperlink{classEpos2MotorController_aeadc7a21fa6619a4104887f169b9d2fd}{enableEpos2}();
    \} \textcolor{keywordflow}{else} \{
        \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"can't initialize device because it's not in
       disable state"}, error);
    \}
\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_a6a3f76a6ed867ed6847d9ebac01136ea}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!init\-Communication@{init\-Communication}}
\index{init\-Communication@{init\-Communication}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{init\-Communication}]{\setlength{\rightskip}{0pt plus 5cm}int Epos2\-Motor\-Controller\-::init\-Communication (
\begin{DoxyParamCaption}
\item[{std\-::string}]{port, }
\item[{unsigned long}]{baudrate, }
\item[{unsigned long}]{timeout}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{classEpos2MotorController_a6a3f76a6ed867ed6847d9ebac01136ea}


build up the communication to a plugged E\-P\-O\-S2. 


\begin{DoxyParams}{Parameters}
{\em port} & the name of the port you want to connect to (U\-S\-B0, U\-S\-B1, ... or /dev/tty\-S0, /dev/tty\-S1, ...) \\
\hline
{\em baudrate} & \mbox{[}bit/s\mbox{]} the frequency for the communication. If it's not set or zero, it will be set to 1000000 (U\-S\-B) or 115200 (R\-S232 -\/ Serial) \\
\hline
{\em timeout} & \mbox{[}ms\mbox{]} If there is no response from the E\-P\-O\-S2 within this time, you will get a communication error. If it's zero or not set, a value of 750 will be used.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if successful otherwise 0 
\end{DoxyReturn}


Definition at line 859 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{int} bit=0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} errorCode=0;

    \textcolor{comment}{//ROS\_ERROR("port: %s, %i", port.c\_str(), port.substr(0,3).compare("USB"));}

    \textcolor{keywordflow}{if} ( port.substr(0,3).compare(\textcolor{stringliteral}{"USB"}) == 0 ) \{
        \textcolor{keywordflow}{if} (baudrate == 0) \{baudrate = 1000000;\}
        \textcolor{keywordflow}{if} (timeout == 0) \{timeout = 750;\}
        \hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle} = VCS\_OpenDevice((\textcolor{keywordtype}{char}*)\textcolor{stringliteral}{"EPOS2"}, (\textcolor{keywordtype}{char}*)\textcolor{stringliteral}{"MAXON
       SERIAL V2"}, (\textcolor{keywordtype}{char}*)\textcolor{stringliteral}{"USB"}, (\textcolor{keywordtype}{char}*) port.c\_str(), &errorCode);
    \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( port.substr(0,8).compare(\textcolor{stringliteral}{"/dev/tty"}) == 0 ) \{
        \textcolor{keywordflow}{if} (baudrate == 0) \{baudrate = 115200;\}
        \textcolor{keywordflow}{if} (timeout == 0) \{timeout = 750;\}
        \hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle} = VCS\_OpenDevice((\textcolor{keywordtype}{char}*)\textcolor{stringliteral}{"EPOS2"}, (\textcolor{keywordtype}{char}*)\textcolor{stringliteral}{"MAXON\_RS232
      "}, (\textcolor{keywordtype}{char}*)\textcolor{stringliteral}{"RS232"}, (\textcolor{keywordtype}{char}*) port.c\_str(), &errorCode);
    \} \textcolor{keywordflow}{else} \{
        \hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle} = 0;
    \}

    this->\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}=\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle};

    \hyperlink{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}{nodeStr}=(\textcolor{keywordtype}{char}*)\textcolor{stringliteral}{"EPOS2"};

    \textcolor{keywordflow}{if} (\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}==0) \{
        \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"can't get devhandle - please check the port
       settings (mostly in the parameter server)"}, fatal, 0, 0x10000003);
        \textcolor{comment}{//errorOutput("open Device", fatal, (int) devhandle, errorCode);}
        \textcolor{keywordflow}{return} 0;
    \} \textcolor{keywordflow}{else} \{
        \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"open Device successfully"}, info, (\textcolor{keywordtype}{int}) \hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{
      devhandle}, errorCode);

        \textcolor{comment}{//set communication parameter}
        bit = VCS\_SetProtocolStackSettings(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, baudrate, 
      timeout, &errorCode);
        \textcolor{keywordflow}{if} (!bit) \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"can't set ProtocollStackSettings"}, fatal, 
      bit, errorCode);
            this->\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle} = 0;
            \textcolor{keywordflow}{return} 0;
        \} \textcolor{keywordflow}{else} \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"set ProtocollStackSettings successfully"}, 
      debug);
            \textcolor{keywordflow}{return} 1;
        \}
    \}
\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_a257e06f445d5ecc34f1dbae30e63fc9f}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!reset\-Device@{reset\-Device}}
\index{reset\-Device@{reset\-Device}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{reset\-Device}]{\setlength{\rightskip}{0pt plus 5cm}int Epos2\-Motor\-Controller\-::reset\-Device (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classEpos2MotorController_a257e06f445d5ecc34f1dbae30e63fc9f}


Reset the State Machine inside the E\-P\-O\-S2. 

\begin{DoxyReturn}{Returns}
1 if successful otherwise 0 
\end{DoxyReturn}


Definition at line 78 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{int} bit=0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} errorCode=0;

    \hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} = \hyperlink{classEpos2MotorController_ac6c31e0dc57485aa817431b22627fc70}{getEpos2State}();

    (\hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} <= \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060ca9c2b33ebbe5a72ad6d09d6af6531237c}{fault}) ? bit = VCS\_ResetDevice(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, 
      \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}, &errorCode) : bit = 0;

    \textcolor{keywordflow}{if} (!bit) \{
        \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"reset device"}, error, bit, errorCode);
        \textcolor{keywordflow}{return} 0;
    \} \textcolor{keywordflow}{else} \{
        \hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} = \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060cae80551bbe5d91631014d56926de2d402}{reset};
        \textcolor{keywordflow}{return} 1;
    \}
\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_aada27a05c4f5150f7b2d2b3ec20a8f84}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!set\-Acceleration\-Data@{set\-Acceleration\-Data}}
\index{set\-Acceleration\-Data@{set\-Acceleration\-Data}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{set\-Acceleration\-Data}]{\setlength{\rightskip}{0pt plus 5cm}int Epos2\-Motor\-Controller\-::set\-Acceleration\-Data (
\begin{DoxyParamCaption}
\item[{{\bf acceleration\-Data} $\ast$}]{parameter}
\end{DoxyParamCaption}
)}}\label{classEpos2MotorController_aada27a05c4f5150f7b2d2b3ec20a8f84}


set all Data restricting the acceleration into the E\-P\-O\-S2. 

changes are only allowed in disabled state.


\begin{DoxyParams}{Parameters}
{\em $\ast$parameter} & structure with all relevant acceleration data \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if successful otherwise 0 
\end{DoxyReturn}


Definition at line 497 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{int} bit = 0, notNegativ = 0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} errorCode, bytesWritten;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} value, value2;

    \textcolor{keywordflow}{if} (\hyperlink{classEpos2MotorController_a8fc2ecc7f9b6398382a96c760dace71a}{errorIfNotBiggerZero}(parameter->
      quickstopDeceleration, \textcolor{stringliteral}{"quickstopDeceleration"}) && \hyperlink{classEpos2MotorController_a8fc2ecc7f9b6398382a96c760dace71a}{errorIfNotBiggerZero}(
      parameter->profileAcceleration, \textcolor{stringliteral}{"profileAcceleration"})) \{
        notNegativ = 1;
    \}
    \textcolor{keywordflow}{if} (\hyperlink{classEpos2MotorController_a8fc2ecc7f9b6398382a96c760dace71a}{errorIfNotBiggerZero}(parameter->profileDeceleration
      , \textcolor{stringliteral}{"profileDeceleration"}) && \hyperlink{classEpos2MotorController_a8fc2ecc7f9b6398382a96c760dace71a}{errorIfNotBiggerZero}(parameter->
      maxAcceleration, \textcolor{stringliteral}{"maxAcceleration"}) && notNegativ) \{
        notNegativ = 1;
    \} \textcolor{keywordflow}{else} \{
        notNegativ = 0;
    \}

    \textcolor{keywordflow}{if} (notNegativ == 1) \{
        \textcolor{comment}{//setting-functions-units are [rev/(min * s)] and input-units are
       [m/(s^2)]}

        value = (\textcolor{keywordtype}{unsigned} int) (parameter->maxAcceleration * 60 * \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}
      .\hyperlink{structEpos2MotorController_1_1epos2Settings_adf387ce695bf432caace5e216dda3429}{gearRatio} / \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab7dfe30a4a13813163437d4d54fa053d}{wheelPerimeter});
        bit = VCS\_SetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , 0x60c5, 0x00, &value, 2, &bytesWritten, &errorCode);
        \textcolor{keywordflow}{if} (!bit) \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"set max Acceleration"}, error, bit, 
      errorCode);
        \}

        value = (\textcolor{keywordtype}{unsigned} int) (parameter->profileAcceleration * 60 * 
      \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_adf387ce695bf432caace5e216dda3429}{gearRatio} / \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.
      \hyperlink{structEpos2MotorController_1_1epos2Settings_ab7dfe30a4a13813163437d4d54fa053d}{wheelPerimeter});
        value2 = (\textcolor{keywordtype}{unsigned} int) (parameter->profileDeceleration * 60 * 
      \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_adf387ce695bf432caace5e216dda3429}{gearRatio} / \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.
      \hyperlink{structEpos2MotorController_1_1epos2Settings_ab7dfe30a4a13813163437d4d54fa053d}{wheelPerimeter});
        bit = VCS\_SetVelocityProfile(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}
      .\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}, value, value2, &errorCode);
        \textcolor{keywordflow}{if} (!bit) \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"set velocity profile acceleration and
       deceleration"}, error, bit, errorCode);
        \}

        value = (\textcolor{keywordtype}{unsigned} int) (parameter->quickstopDeceleration * 60 * 
      \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_adf387ce695bf432caace5e216dda3429}{gearRatio} / \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.
      \hyperlink{structEpos2MotorController_1_1epos2Settings_ab7dfe30a4a13813163437d4d54fa053d}{wheelPerimeter});
        bit = VCS\_SetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , 0x6085, 0x00, &value, 2, &bytesWritten, &errorCode);
        \textcolor{keywordflow}{if} (!bit) \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"set max QuickStopDeceleration"}, error, bit,
       errorCode);
        \}

        \textcolor{keywordflow}{return} 1;
    \} \textcolor{keywordflow}{else} \{
        \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"No Acceleration Values will be set because at
       least one parameter is not valid."});
        \textcolor{keywordflow}{return} 0;
    \}
\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_a8eb9d184e96079a5a995776cf3a453f2}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!set\-Dimension\-And\-Notation@{set\-Dimension\-And\-Notation}}
\index{set\-Dimension\-And\-Notation@{set\-Dimension\-And\-Notation}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{set\-Dimension\-And\-Notation}]{\setlength{\rightskip}{0pt plus 5cm}int Epos2\-Motor\-Controller\-::set\-Dimension\-And\-Notation (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{classEpos2MotorController_a8eb9d184e96079a5a995776cf3a453f2}


set how the numbers sending to the E\-P\-O\-S2 will be interpreted. 

it's set for position/way, velocity and acceleration. The velocity Notation index is set to e-\/3 because the velocity will be set as integers it increases the accuracy. changes are only allowed in disabled state.

\begin{DoxyReturn}{Returns}
1 if successful otherwise 0 
\end{DoxyReturn}


Definition at line 758 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{int} bit=0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} errorCode=0, bytesWritten=0;
    \textcolor{keywordtype}{short} signValue = 0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} unsignValue = 0;

    \hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} = \hyperlink{classEpos2MotorController_ac6c31e0dc57485aa817431b22627fc70}{getEpos2State}();

    \textcolor{keywordflow}{if} (\hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} == \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060caf0eea74682d3d3f21bec6e5b376cf443}{disabled}) \{

        unsignValue = 0xac;
        bit = VCS\_SetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , 0x608a, 0x00, &unsignValue, 1, &bytesWritten, &errorCode);
        \textcolor{keywordflow}{if} (!bit) \{ \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"set Position Dimension Index"}, 
      error, bit, errorCode);\}

        unsignValue = 0xa4;
        bit = VCS\_SetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , 0x608c, 0x00, &unsignValue, 2, &bytesWritten, &errorCode);
        \textcolor{keywordflow}{if} (!bit) \{ \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"set Velocity Dimension Index"}, 
      error, bit, errorCode);\}

        \textcolor{comment}{//unsignValue = 0xa4;}
        bit = VCS\_SetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , 0x608e, 0x00, &unsignValue, 1, &bytesWritten, &errorCode);
        \textcolor{keywordflow}{if} (!bit) \{ \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"set Acceleration Dimension Index"}, 
      error, bit, errorCode);\}

        signValue = 0x0;
        bit = VCS\_SetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , 0x6089, 0x00, &signValue, 1, &bytesWritten, &errorCode);
        \textcolor{keywordflow}{if} (!bit) \{ \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"set Position Notation Index"}, error
      , bit, errorCode);\}

        signValue = 0xfd;
        bit = VCS\_SetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , 0x608b, 0x00, &signValue, 1, &bytesWritten, &errorCode);
        \textcolor{keywordflow}{if} (!bit) \{ \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"set Velocity Notation Index"}, error
      , bit, errorCode);\}

        signValue = 0x0;
        bit = VCS\_SetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , 0x608d, 0x00, &signValue, 1, &bytesWritten, &errorCode);
        \textcolor{keywordflow}{if} (!bit) \{ \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"set Acceleration Notation Index"}, 
      error, bit, errorCode);\}

        \textcolor{keywordflow}{return} 1;
    \} \textcolor{keywordflow}{else} \{
        \textcolor{keywordflow}{return} 0;
    \}
\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_a6c806fba7028bed11d710c4f453869b1}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!set\-Gear\-Data@{set\-Gear\-Data}}
\index{set\-Gear\-Data@{set\-Gear\-Data}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{set\-Gear\-Data}]{\setlength{\rightskip}{0pt plus 5cm}int Epos2\-Motor\-Controller\-::set\-Gear\-Data (
\begin{DoxyParamCaption}
\item[{{\bf gear\-Data} $\ast$}]{parameter}
\end{DoxyParamCaption}
)}}\label{classEpos2MotorController_a6c806fba7028bed11d710c4f453869b1}


set all Data of the gear into the E\-P\-O\-S2. 

changes are only allowed in disabled state.


\begin{DoxyParams}{Parameters}
{\em $\ast$parameter} & structure with all relevant gear data \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if successful otherwise 0 
\end{DoxyReturn}


Definition at line 367 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{int} bit=0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} errorCode=0, bytesWritten=0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} value = 1;    \textcolor{comment}{//gearRatio in EPOS2 will set to because only
       the velocity limitation work but the target velocity will be set before (motor
       side) instead after the gear (wheel side)}

    \hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} = \hyperlink{classEpos2MotorController_ac6c31e0dc57485aa817431b22627fc70}{getEpos2State}();

    \textcolor{keywordflow}{if} (\hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} == \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060caf0eea74682d3d3f21bec6e5b376cf443}{disabled}) \{

        bit = VCS\_SetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , 0x2230, 0x01, &value, 4, &bytesWritten, &errorCode);
        \textcolor{keywordflow}{if} (!bit) \{ \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"set Gear-Numerator"}, error, bit, 
      errorCode);\}

        bit = VCS\_SetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , 0x2230, 0x02, &value, 2, &bytesWritten, &errorCode);
        \textcolor{keywordflow}{if} (!bit) \{ \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"set Gear-Denominator"}, error, bit, 
      errorCode);\}

        value = abs(parameter->maxRPM);
        bit = VCS\_SetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , 0x2230, 0x03, &value, 4, &bytesWritten, &errorCode);
        \textcolor{keywordflow}{if} (!bit) \{ \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"set max RPM of Gear"}, error, bit, 
      errorCode);\}

        \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_a1524dd1ea0ca97addfa48ec2ba983c3e}{gearNumerator} = parameter->
      numerator;
        \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_af648530b886ebd8176997645c99aa35b}{gearDenomiantor} = parameter->
      denominator;
        \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_adf387ce695bf432caace5e216dda3429}{gearRatio} = \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}
      .\hyperlink{structEpos2MotorController_1_1epos2Settings_a1524dd1ea0ca97addfa48ec2ba983c3e}{gearNumerator} / \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_af648530b886ebd8176997645c99aa35b}{gearDenomiantor}
      ;

        \textcolor{keywordflow}{return} 1;
    \} \textcolor{keywordflow}{else} \{
        \textcolor{keywordflow}{return} 0;
    \}
\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_a60d132d6d79c0b8d49eb5ed721aae790}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!set\-Max\-R\-P\-M@{set\-Max\-R\-P\-M}}
\index{set\-Max\-R\-P\-M@{set\-Max\-R\-P\-M}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{set\-Max\-R\-P\-M}]{\setlength{\rightskip}{0pt plus 5cm}int Epos2\-Motor\-Controller\-::set\-Max\-R\-P\-M (
\begin{DoxyParamCaption}
\item[{double}]{max\-R\-P\-M}
\end{DoxyParamCaption}
)}}\label{classEpos2MotorController_a60d132d6d79c0b8d49eb5ed721aae790}


set the highest allowed angular velocity into the E\-P\-O\-S2. 

changes are only allowed in disabled state.


\begin{DoxyParams}{Parameters}
{\em max\-R\-P\-M} & highest allowed angular velocity \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if successful otherwise 0 
\end{DoxyReturn}


Definition at line 580 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{int} bit=0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} errorCode=0, bytesWritten=0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} value = abs(maxRPM*1000*\hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_adf387ce695bf432caace5e216dda3429}{gearRatio}
      );

    \hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} = \hyperlink{classEpos2MotorController_ac6c31e0dc57485aa817431b22627fc70}{getEpos2State}();

    \textcolor{keywordflow}{if} (\hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} == \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060caf0eea74682d3d3f21bec6e5b376cf443}{disabled}) \{

        bit = VCS\_SetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , 0x607f, 0x00, &value, 4, &bytesWritten, &errorCode);
        \textcolor{keywordflow}{if} (!bit) \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"set max RPM of wheels"}, error, bit, 
      errorCode);
        \} \textcolor{keywordflow}{else} \{
            \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_a7bc89f766fbe9abcb503572714422658}{maxRotationPerMinute}
       = maxRPM;
        \}

        ROS\_INFO(\textcolor{stringliteral}{"maxRPM set to: %.4lf"}, maxRPM);

        \textcolor{keywordflow}{return} 1;
    \} \textcolor{keywordflow}{else} \{
        \textcolor{keywordflow}{return} 0;
    \}
\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_a0a5257b20692de37091544e6ed5f6aed}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!set\-Motor\-Data@{set\-Motor\-Data}}
\index{set\-Motor\-Data@{set\-Motor\-Data}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{set\-Motor\-Data}]{\setlength{\rightskip}{0pt plus 5cm}int Epos2\-Motor\-Controller\-::set\-Motor\-Data (
\begin{DoxyParamCaption}
\item[{{\bf motor\-Data} $\ast$}]{parameter}
\end{DoxyParamCaption}
)}}\label{classEpos2MotorController_a0a5257b20692de37091544e6ed5f6aed}


set all Data of the motor into the E\-P\-O\-S2. 

changes are only allowed in disabled state. max\-Peak\-Current will be the double value of continous\-Current, if continous\-Current is higher than max\-Peak\-Current


\begin{DoxyParams}{Parameters}
{\em $\ast$parameter} & structure with all relevant motor data \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if successful otherwise 0 
\end{DoxyReturn}


Definition at line 429 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{int} bit=0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} errorCode=0, bytesWritten=0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} value = abs(parameter->maxRPM);

    \hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} = \hyperlink{classEpos2MotorController_ac6c31e0dc57485aa817431b22627fc70}{getEpos2State}();

    \textcolor{keywordflow}{if} (\hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} == \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060caf0eea74682d3d3f21bec6e5b376cf443}{disabled}) \{

        bit = VCS\_SetMotorType(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.
      \hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}, MT\_DC\_MOTOR, &errorCode);
        \textcolor{keywordflow}{if} (!bit) \{ \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"can't set motorType to brushed DC"},
       error, bit, errorCode);\}

        \textcolor{keywordflow}{if} (parameter->maxPeakCurrent < parameter->continuousCurrent) \{ 
      parameter->maxPeakCurrent = 2 * parameter->continuousCurrent;\}

        bit = VCS\_SetDcMotorParameter(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}
      .\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}, parameter->continuousCurrent, parameter->maxPeakCurrent, parameter->
      thermalTimeConstantWinding, &errorCode);
        \textcolor{keywordflow}{if} (bit != 0) \{
            ROS\_DEBUG(\textcolor{stringliteral}{"MotorData set %s to: NominalCurrent - %i, PeakCurrent -
       %i, ThermalTimeConstant - %i"}, \hyperlink{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}{nodeStr}, parameter->continuousCurrent, 
      parameter->maxPeakCurrent, parameter->thermalTimeConstantWinding);
        \} \textcolor{keywordflow}{else} \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"couldn't set DC-Motor parameter"}, warn, bit
      , errorCode);
        \}

        bit = VCS\_SetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , 0x6410, 0x04, &value, 4, &bytesWritten, &errorCode);
        \textcolor{keywordflow}{if} (bit != 0) \{
            ROS\_DEBUG(\textcolor{stringliteral}{"Maximum Velocity set %s to: %li rpm"}, \hyperlink{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}{nodeStr}, 
      parameter->maxRPM);
        \} \textcolor{keywordflow}{else} \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"couldn't set maximum RPM of Motor"}, warn, 
      bit, errorCode);
        \}

        \textcolor{keywordflow}{return} 1;
    \} \textcolor{keywordflow}{else} \{
        \textcolor{keywordflow}{return} 0;
    \}
\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_a42c80ac11a2d4dfcb4f75a573e017164}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!set\-Regulator\-Parameter@{set\-Regulator\-Parameter}}
\index{set\-Regulator\-Parameter@{set\-Regulator\-Parameter}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{set\-Regulator\-Parameter}]{\setlength{\rightskip}{0pt plus 5cm}int Epos2\-Motor\-Controller\-::set\-Regulator\-Parameter (
\begin{DoxyParamCaption}
\item[{{\bf regulator} $\ast$}]{parameter}
\end{DoxyParamCaption}
)}}\label{classEpos2MotorController_a42c80ac11a2d4dfcb4f75a573e017164}


set all parameter of the regulators into the E\-P\-O\-S2. 

changes are only allowed in disabled state.


\begin{DoxyParams}{Parameters}
{\em $\ast$parameter} & structure with all regulator gain and feedforward values \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if successful otherwise 0 
\end{DoxyReturn}


Definition at line 680 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{int} bit=0, bit1 = 0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} errorCode=0, bytesWritten=0;

    \hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} = \hyperlink{classEpos2MotorController_ac6c31e0dc57485aa817431b22627fc70}{getEpos2State}();

    \textcolor{keywordflow}{if} (\hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} == \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060caf0eea74682d3d3f21bec6e5b376cf443}{disabled}) \{

        bit = VCS\_SetPositionRegulatorGain(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}
      .\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}, (*parameter).positionGain.p, (*parameter).positionGain.i, 
      (*parameter).positionGain.d, &errorCode);
        \textcolor{keywordflow}{if} (bit != 0) \{
            ROS\_INFO(\textcolor{stringliteral}{"PositionGain was set %s to: P - %i, I - %i, D - %i"}, 
      \hyperlink{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}{nodeStr}, (*parameter).positionGain.p, (*parameter).positionGain.i, 
      (*parameter).positionGain.d);
        \} \textcolor{keywordflow}{else} \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"couldn't write Position Gain Values"}, warn,
       bit, errorCode);
        \}

        bit = VCS\_SetPositionRegulatorFeedForward(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, 
      \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}, (*parameter).positionFF.Velocity, 
      (*parameter).positionFF.Acceleration, &errorCode);
        \textcolor{keywordflow}{if} (bit != 0) \{
            ROS\_INFO(\textcolor{stringliteral}{"PositionFeedForward was set %s to: Velocity - %i,
       Acceleration - %i"}, \hyperlink{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}{nodeStr}, (*parameter).positionFF.Velocity, (*parameter).
      positionFF.Acceleration);
        \} \textcolor{keywordflow}{else} \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"couldn't write Position FeedForward Values"}
      , warn, bit, errorCode);
        \}

        bit = VCS\_SetVelocityRegulatorGain(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}
      .\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}, (*parameter).velocityGain.p, (*parameter).velocityGain.i, &errorCode)
      ;
        \textcolor{keywordflow}{if} (bit != 0) \{
            ROS\_INFO(\textcolor{stringliteral}{"VelocityGain was set %s to: P - %i, I - %i"}, \hyperlink{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}{nodeStr}
      , (*parameter).velocityGain.p, (*parameter).velocityGain.i);
        \} \textcolor{keywordflow}{else} \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"couldn't write Velocity Gain Values"}, warn,
       bit, errorCode);
        \}

        bit = VCS\_SetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , 0x60f9, 0x04, (\textcolor{keywordtype}{short} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} *) &(*parameter).velocityFF.Velocity, 2, &
      bytesWritten, &errorCode);
        bit1 = VCS\_SetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{
      node}, 0x60f9, 0x05, (\textcolor{keywordtype}{short} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} *) &(*parameter).velocityFF.
      Acceleration, 2, &bytesWritten, &errorCode);
        \textcolor{keywordflow}{if} (bit != 0 && bit1 !=0) \{
            ROS\_INFO(\textcolor{stringliteral}{"VelocityFeedForward was set %s to: Velocity - %i,
       Acceleration - %i"}, \hyperlink{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}{nodeStr}, (*parameter).velocityFF.Velocity, (*parameter).
      velocityFF.Acceleration);
        \} \textcolor{keywordflow}{else} \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"couldn't write Velocity FeedForward Values"}
      , warn, bit, errorCode);
        \}

        bit = VCS\_SetCurrentRegulatorGain(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}
      .\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}, (*parameter).currentGain.p, (*parameter).currentGain.i, &errorCode);
        \textcolor{keywordflow}{if} (bit != 0) \{
            ROS\_INFO(\textcolor{stringliteral}{"CurrentGain was set %s to: P - %i, I - %i"}, \hyperlink{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}{nodeStr}
      , (*parameter).currentGain.p, (*parameter).currentGain.i);
        \} \textcolor{keywordflow}{else} \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"couldn't write Current Gain Values"}, warn, 
      bit, errorCode);
        \}

        \textcolor{keywordflow}{return} 1;
    \} \textcolor{keywordflow}{else} \{
        \textcolor{keywordflow}{return} 0;
    \}
\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_a2ff727bd7ad81302c2feaaf297d888ae}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!set\-Spin@{set\-Spin}}
\index{set\-Spin@{set\-Spin}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{set\-Spin}]{\setlength{\rightskip}{0pt plus 5cm}int Epos2\-Motor\-Controller\-::set\-Spin (
\begin{DoxyParamCaption}
\item[{int}]{reverse}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{classEpos2MotorController_a2ff727bd7ad81302c2feaaf297d888ae}


set the positive direction of movement into the E\-P\-O\-S2. 

changes are only allowed in disabled state.


\begin{DoxyParams}{Parameters}
{\em reverse} & if it's 1 the positive direction is C\-W otherwise C\-C\-W \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if successful otherwise 0 
\end{DoxyReturn}


Definition at line 733 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{int} bit=0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} errorCode=0, bytesWritten=0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} value;

    \hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} = \hyperlink{classEpos2MotorController_ac6c31e0dc57485aa817431b22627fc70}{getEpos2State}();

    \textcolor{keywordflow}{if} (\hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} == \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060caf0eea74682d3d3f21bec6e5b376cf443}{disabled}) \{

        value = (reverse == 1) ? 0x0100 : 0x0000;

        bit = VCS\_SetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , 0x2008, 0x00, &value, 2, &bytesWritten, &errorCode);
        \textcolor{keywordflow}{if} (!bit) \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"change Spin"}, error, bit, errorCode);
            \textcolor{keywordflow}{return} 0;
        \} \textcolor{keywordflow}{else} \{
            \textcolor{keywordflow}{return} 1;
        \}
    \} \textcolor{keywordflow}{else} \{
        \textcolor{keywordflow}{return} 0;
    \}

\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_a2e1ad71a3be2943ed7bffd743c4f1fad}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!store\-Settings@{store\-Settings}}
\index{store\-Settings@{store\-Settings}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{store\-Settings}]{\setlength{\rightskip}{0pt plus 5cm}int Epos2\-Motor\-Controller\-::store\-Settings (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classEpos2MotorController_a2e1ad71a3be2943ed7bffd743c4f1fad}


stores all changed Settings in the E\-P\-O\-S2. 

this should be done after changing settings and before enabling the E\-P\-O\-S2.

\begin{DoxyReturn}{Returns}
1 if successful otherwise 0 
\end{DoxyReturn}


Definition at line 211 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{int} bit=0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} errorCode=0;

    \hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} = \hyperlink{classEpos2MotorController_ac6c31e0dc57485aa817431b22627fc70}{getEpos2State}();

    \textcolor{keywordflow}{if} (\hyperlink{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{state} == \hyperlink{classEpos2MotorController_ab5ec630dfbb90ad674e311187926060caf0eea74682d3d3f21bec6e5b376cf443}{disabled}) \{

        bit = VCS\_Store(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , &errorCode);
        \textcolor{keywordflow}{if} (bit == 0) \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"couldn't store Parameter"}, warn, bit, 
      errorCode);
            \textcolor{keywordflow}{return} 0;
        \} \textcolor{keywordflow}{else} \{
            \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"Parameters saved"});
            \textcolor{keywordflow}{return} 1;
        \}

    \} \textcolor{keywordflow}{else} \{
        \textcolor{keywordflow}{return} 0;
    \}
\}
\end{DoxyCode}
\hypertarget{classEpos2MotorController_a481615a590e6d1c6bf6c39c426e6d9a6}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!test\-For\-Errors\-And\-Print@{test\-For\-Errors\-And\-Print}}
\index{test\-For\-Errors\-And\-Print@{test\-For\-Errors\-And\-Print}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{test\-For\-Errors\-And\-Print}]{\setlength{\rightskip}{0pt plus 5cm}int Epos2\-Motor\-Controller\-::test\-For\-Errors\-And\-Print (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classEpos2MotorController_a481615a590e6d1c6bf6c39c426e6d9a6}


read out the error bit and the error history. 

If an error was detected a message will be send to ros\-O\-U\-T.

\begin{DoxyReturn}{Returns}
0 if a Device\-Error was detect, else return 1 
\end{DoxyReturn}


Definition at line 117 of file Epos2\-Motor\-Controller.\-cpp.


\begin{DoxyCode}
\{
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} numberOfDeviceError = 0;
    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} errorCode=0, deviceErrorCode, bytesRead;
    \textcolor{keywordtype}{int} bit = 0, bit2 = 0, noError = 1;
    \textcolor{keywordtype}{short} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} value=0;

    bit = VCS\_GetObject(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}.\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}
      , 0x1001, 0x00, &value, 1, &bytesRead, &errorCode);

    \textcolor{comment}{//ROS\_ERROR("ErrorValue: %u", value);}

    \textcolor{keywordflow}{if} (bit != 0) \{
        \textcolor{keywordflow}{if} (value != 0) \{
            noError = 0;
            \textcolor{comment}{//first shift until the wanted byte is first, then bitwiseAnd with
       0000 0001 and check if it's zero or one}
            \textcolor{keywordflow}{if} ((value >> 0) & 0x01 == 1) \{\hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"DeviceError:
       Generic error"}, error);\}
            \textcolor{keywordflow}{if} ((value >> 1) & 0x01 == 1) \{\hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"DeviceError:
       Current error"}, error);\}
            \textcolor{keywordflow}{if} ((value >> 2) & 0x01 == 1) \{\hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"DeviceError:
       Voltage error"}, error);\}
            \textcolor{keywordflow}{if} ((value >> 3) & 0x01 == 1) \{\hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"DeviceError:
       Temperature error"}, error);\}
            \textcolor{keywordflow}{if} ((value >> 4) & 0x01 == 1) \{\hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"DeviceError:
       Communication error"}, error);\}
            \textcolor{keywordflow}{if} ((value >> 5) & 0x01 == 1) \{\hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"DeviceError:
       Device profile-specific error"}, error);\}
            \textcolor{keywordflow}{if} ((value >> 7) & 0x01 == 1) \{\hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"DeviceError:
       Motion error"}, error);\}
        \}
    \} \textcolor{keywordflow}{else} \{
        \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"Couldn't read internal error Register (0x1001).
      "}, error, 0, errorCode);
    \}

    bit = VCS\_GetNbOfDeviceError (\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}
      .\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}, &numberOfDeviceError, &errorCode);

    \textcolor{comment}{//ROS\_ERROR("Number of DeviceErrors: %u", numberOfDeviceError);}

    \textcolor{keywordflow}{if}(bit != 0) \{
        \textcolor{keywordflow}{if} (numberOfDeviceError != 0) \{
            noError = 0;
            \textcolor{comment}{//read device error code}
            \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 1; i <= numberOfDeviceError; i++) \{

                bit2 = VCS\_GetDeviceErrorCode(\hyperlink{classEpos2MotorController_a40594faab444bcba221ab9d55d1162cd}{devhandle}, \hyperlink{classEpos2MotorController_a0856f5fdd71ffa3b84a536afa085bfb1}{epos2MotorSet}
      .\hyperlink{structEpos2MotorController_1_1epos2Settings_ab8f18d3df17e8de9ed5250a3e53292c6}{node}, i, &deviceErrorCode, &errorCode);
                \textcolor{keywordflow}{if}(bit2 != 0) \{
                    \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"The following Error was detected.
       (ErrorBit = ErrorNumber)"}, error, i, deviceErrorCode);
                \} \textcolor{keywordflow}{else} \{
                    \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"Couldn't read the deviceError with
       the Number behind ErrorBit."}, error, i, errorCode);
                \}
            \}
        \}
    \} \textcolor{keywordflow}{else} \{
        \hyperlink{classEpos2MotorController_a64d5e3e3858597c111e60ba8b382a63b}{errorOutput}(\textcolor{stringliteral}{"Couldn't read the number of device errors."}, 
      error, bit, errorCode);
    \}

    \textcolor{keywordflow}{return} noError;
\}
\end{DoxyCode}


\subsection{Field Documentation}
\hypertarget{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!node\-Str@{node\-Str}}
\index{node\-Str@{node\-Str}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{node\-Str}]{\setlength{\rightskip}{0pt plus 5cm}char$\ast$ Epos2\-Motor\-Controller\-::node\-Str}}\label{classEpos2MotorController_aec7abbd4cd8e70e98f28cae457275e31}


this appears in front of a message published with R\-O\-S. 

If not set it's \char`\"{}\-E\-P\-O\-S2\char`\"{}. 

Definition at line 46 of file Epos2\-Motor\-Controller.\-h.

\hypertarget{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}{\index{Epos2\-Motor\-Controller@{Epos2\-Motor\-Controller}!state@{state}}
\index{state@{state}!Epos2MotorController@{Epos2\-Motor\-Controller}}
\subsubsection[{state}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Epos\-State} Epos2\-Motor\-Controller\-::state\hspace{0.3cm}{\ttfamily [private]}}}\label{classEpos2MotorController_a7194b8efd4f2fd5a4d64b10135c416e2}


the state inside this class depending on the state of the E\-P\-O\-S2 

\begin{DoxySeeAlso}{See Also}
\hyperlink{classEpos2MotorController_ac6c31e0dc57485aa817431b22627fc70}{get\-Epos2\-State()} 
\end{DoxySeeAlso}


Definition at line 344 of file Epos2\-Motor\-Controller.\-h.



The documentation for this class was generated from the following files\-:\begin{DoxyCompactItemize}
\item 
src/epos2\-\_\-control/src/Epos2\-Motor\-Controller.\-h\item 
src/epos2\-\_\-control/src/Epos2\-Motor\-Controller.\-cpp\end{DoxyCompactItemize}
